import os
import pathlib
import subprocess
from io import StringIO
import pandas as pd
import numpy as np
from scipy import spatial

from .helpers import *


class BuroHappold(object):

    def __init__(self):

        self.colors = {
            "official": {
                "BrightGreen": [108, 194, 78],
                "BrightPurple": [112, 47, 138],
                "BrightRed": [213, 0, 50],
                "DarkBlue": [0, 97, 127],
                "DarkRed": [126, 45, 64],
                "Green": [34, 136, 72],
                "Grey": [150, 140, 131],
                "LightBlue": [141, 185, 202],
                "LightRed": [188, 32, 75],
                "Orange": [255, 143, 28],
                "Pink": [231, 130, 169],
                "Purple": [36, 19, 95],
                "BrandGreen": [196, 214, 0],
                "Teal": [0, 164, 153],
            },
            "ppt": {
                "Purple": [143, 114, 176],
                "BrandGreen": [196, 214, 0],
                "Pink": [230, 49, 135],
                "LightBlue": [0, 176, 240],
                "DarkBlue": [28, 54, 96],
                "Orange": [235, 103, 28],
                "DarkPurple": [85, 62, 112],
                "DarkGreen": [118, 128, 0],
                "DarkPink": [149, 18, 80],
                "Blue": [0, 106, 144],
                "ReallyDarkBlue": [17, 32, 58],
                "Brown": [145, 61, 13],
            },
        }


class EPW(object):

    def __init__(self, file_path):

        # NV method variables
        self.vec = None
        self.thetas = None
        self.sky = None
        self.sky_emissivity = None
        self.nv_horizontal_ir = None
        self.convective_heat_transfer_coefficient = None
        self.distances = None
        self.indices = None

        # Metadata
        self.filepath = os.path.abspath(file_path) if file_path is not None else None

        # Location variables
        self.city = None
        self.region = None
        self.country = None
        self.dataset_type = None
        self.station_id = None
        self.latitude = None
        self.longitude = None
        self.elevation = None
        self.time_zone = None
        self.design_conditions = None
        self.typical_extreme_periods = None
        self.ground_temperatures = None
        self.holidays_daylight_savings = None
        self.comments_1 = None
        self.comments_2 = None

        # Series variables
        self.df = None
        self.data_source_and_uncertainty_flags = None
        self.dry_bulb_temperature = None
        self.dew_point_temperature = None
        self.relative_humidity = None
        self.atmospheric_station_pressure = None
        self.extraterrestrial_horizontal_radiation = None
        self.extraterrestrial_direct_normal_radiation = None
        self.horizontal_infrared_radiation_intensity = None
        self.global_horizontal_radiation = None
        self.direct_normal_radiation = None
        self.diffuse_horizontal_radiation = None
        self.global_horizontal_illuminance = None
        self.direct_normal_illuminance = None
        self.diffuse_horizontal_illuminance = None
        self.zenith_luminance = None
        self.wind_direction = None
        self.wind_speed = None
        self.total_sky_cover = None
        self.opaque_sky_cover = None
        self.visibility = None
        self.ceiling_height = None
        self.present_weather_observation = None
        self.present_weather_codes = None
        self.precipitable_water = None
        self.aerosol_optical_depth = None
        self.snow_depth = None
        self.days_since_last_snowfall = None
        self.albedo = None
        self.liquid_precipitation_depth = None
        self.liquid_precipitation_quantity = None

        # Derived variables
        self.partial_vapour_pressure = None
        self.solar_altitude = None
        self.solar_azimuth = None
        self.wet_bulb_temperature = None
        self.enthalpy = None
        self.humidity_ratio = None
        self.universal_thermal_climate_index = None
        self.standard_effective_temperature = None
        self.solar_adjusted_mean_radiant_temperature = None
        self.mean_radiant_temperature = None
        self.ground_temperature_at_depth = None
        self.pedestrian_wind_speed = None
        self.direct_sky_matrix = None
        self.diffuse_sky_matrix = None
        self.total_sky_matrix = None

        # Path variables
        self.wea_file = None
        self.csv_file = None

        # Fixed variables
        self.radiation_rose_vectors = np.array([
            [0.0, 1.0, 0.0],
            [-0.17364817766693033, 0.98480775301220802, 0.0],
            [-0.34202014332566871, 0.93969262078590843, 0.0],
            [-0.49999999999999994, 0.86602540378443871, 0.0],
            [-0.64278760968653925, 0.76604444311897801, 0.0],
            [-0.76604444311897801, 0.64278760968653936, 0.0],
            [-0.8660254037844386, 0.50000000000000011, 0.0],
            [-0.93969262078590832, 0.34202014332566882, 0.0],
            [-0.98480775301220802, 0.17364817766693041, 0.0],
            [-1.0, 0.0, 0.0],
            [-0.98480775301220802, -0.1736481776669303, 0.0],
            [-0.93969262078590843, -0.34202014332566871, 0.0],
            [-0.86602540378443871, -0.49999999999999978, 0.0],
            [-0.76604444311897801, -0.64278760968653936, 0.0],
            [-0.64278760968653947, -0.7660444431189779, 0.0],
            [-0.49999999999999994, -0.86602540378443871, 0.0],
            [-0.34202014332566888, -0.93969262078590832, 0.0],
            [-0.17364817766693028, -0.98480775301220802, 0.0],
            [0.0, -1.0, 0.0],
            [0.17364817766693047, -0.98480775301220802, 0.0],
            [0.34202014332566866, -0.93969262078590843, 0.0],
            [0.50000000000000011, -0.8660254037844386, 0.0],
            [0.64278760968653925, -0.76604444311897801, 0.0],
            [0.7660444431189779, -0.64278760968653947, 0.0],
            [0.86602540378443837, -0.50000000000000044, 0.0],
            [0.93969262078590821, -0.34202014332566938, 0.0],
            [0.98480775301220802, -0.17364817766693033, 0.0],
            [1.0, 0.0, 0.0],
            [0.98480775301220813, 0.17364817766692997, 0.0],
            [0.93969262078590854, 0.34202014332566816, 0.0],
            [0.8660254037844386, 0.50000000000000011, 0.0],
            [0.76604444311897812, 0.64278760968653925, 0.0],
            [0.64278760968653958, 0.76604444311897779, 0.0],
            [0.50000000000000044, 0.86602540378443837, 0.0],
            [0.3420201433256686, 0.93969262078590843, 0.0],
            [0.17364817766693127, 0.98480775301220791, 0.0],
        ])
        self.radiation_rose_angles = np.radians(np.arange(0, 360, 10))[::-1]
        self.tregenza_sky_dome = {
            "patch_centroids": np.array([
                [0, 99.756283, 5.405868],
                [10.427371, 99.209807, 5.405868],
                [20.740497, 97.576367, 5.405868],
                [30.826387, 94.873862, 5.405868],
                [40.574535, 91.131899, 5.405868],
                [49.878141, 86.391475, 5.405868],
                [58.635271, 80.704528, 5.405868],
                [66.749981, 74.133365, 5.405868],
                [74.133365, 66.749981, 5.405868],
                [80.704528, 58.635271, 5.405868],
                [86.391475, 49.878141, 5.405868],
                [91.131899, 40.574535, 5.405868],
                [94.873862, 30.826387, 5.405868],
                [97.576367, 20.740497, 5.405868],
                [99.209807, 10.427371, 5.405868],
                [99.756283, 0, 5.405868],
                [99.209807, -10.427371, 5.405868],
                [97.576367, -20.740497, 5.405868],
                [94.873862, -30.826387, 5.405868],
                [91.131899, -40.574535, 5.405868],
                [86.391475, -49.878141, 5.405868],
                [80.704528, -58.635271, 5.405868],
                [74.133365, -66.749981, 5.405868],
                [66.749981, -74.133365, 5.405868],
                [58.635271, -80.704528, 5.405868],
                [49.878141, -86.391475, 5.405868],
                [40.574535, -91.131899, 5.405868],
                [30.826387, -94.873862, 5.405868],
                [20.740497, -97.576367, 5.405868],
                [10.427371, -99.209807, 5.405868],
                [0, -99.756283, 5.405868],
                [-10.427371, -99.209807, 5.405868],
                [-20.740497, -97.576367, 5.405868],
                [-30.826387, -94.873862, 5.405868],
                [-40.574535, -91.131899, 5.405868],
                [-49.878141, -86.391475, 5.405868],
                [-58.635271, -80.704528, 5.405868],
                [-66.749981, -74.133365, 5.405868],
                [-74.133365, -66.749981, 5.405868],
                [-80.704528, -58.635271, 5.405868],
                [-86.391475, -49.878141, 5.405868],
                [-91.131899, -40.574535, 5.405868],
                [-94.873862, -30.826387, 5.405868],
                [-97.576367, -20.740497, 5.405868],
                [-99.209807, -10.427371, 5.405868],
                [-99.756283, 0, 5.405868],
                [-99.209807, 10.427371, 5.405868],
                [-97.576367, 20.740497, 5.405868],
                [-94.873862, 30.826387, 5.405868],
                [-91.131899, 40.574535, 5.405868],
                [-86.391475, 49.878141, 5.405868],
                [-80.704528, 58.635271, 5.405868],
                [-74.133365, 66.749981, 5.405868],
                [-66.749981, 74.133365, 5.405868],
                [-58.635271, 80.704528, 5.405868],
                [-49.878141, 86.391475, 5.405868],
                [-40.574535, 91.131899, 5.405868],
                [-30.826387, 94.873862, 5.405868],
                [-20.740497, 97.576367, 5.405868],
                [-10.427371, 99.209807, 5.405868],
                [0, 98.58904, 16.154225],
                [10.305361, 98.048959, 16.154225],
                [20.497814, 96.434632, 16.154225],
                [30.465689, 93.763749, 16.154226],
                [40.099775, 90.06557, 16.154225],
                [49.29452, 85.380613, 16.154225],
                [57.949183, 79.760209, 16.154226],
                [65.968943, 73.265935, 16.154225],
                [73.265935, 65.968943, 16.154225],
                [79.760209, 57.949183, 16.154226],
                [85.380613, 49.29452, 16.154225],
                [90.06557, 40.099775, 16.154225],
                [93.763749, 30.465689, 16.154226],
                [96.434632, 20.497814, 16.154225],
                [98.048959, 10.305361, 16.154225],
                [98.58904, 0, 16.154225],
                [98.048959, -10.305361, 16.154225],
                [96.434632, -20.497814, 16.154225],
                [93.763749, -30.465689, 16.154226],
                [90.06557, -40.099775, 16.154225],
                [85.380613, -49.29452, 16.154225],
                [79.760209, -57.949183, 16.154226],
                [73.265935, -65.968943, 16.154225],
                [65.968943, -73.265935, 16.154225],
                [57.949183, -79.760209, 16.154226],
                [49.29452, -85.380613, 16.154225],
                [40.099775, -90.06557, 16.154225],
                [30.465689, -93.763749, 16.154226],
                [20.497814, -96.434632, 16.154225],
                [10.305361, -98.048959, 16.154225],
                [0, -98.58904, 16.154225],
                [-10.305361, -98.048959, 16.154225],
                [-20.497814, -96.434632, 16.154225],
                [-30.465689, -93.763749, 16.154226],
                [-40.099775, -90.06557, 16.154225],
                [-49.29452, -85.380613, 16.154225],
                [-57.949183, -79.760209, 16.154226],
                [-65.968943, -73.265935, 16.154225],
                [-73.265935, -65.968943, 16.154225],
                [-79.760209, -57.949183, 16.154226],
                [-85.380613, -49.29452, 16.154225],
                [-90.06557, -40.099775, 16.154225],
                [-93.763749, -30.465689, 16.154226],
                [-96.434632, -20.497814, 16.154225],
                [-98.048959, -10.305361, 16.154225],
                [-98.58904, 0, 16.154225],
                [-98.048959, 10.305361, 16.154225],
                [-96.434632, 20.497814, 16.154225],
                [-93.763749, 30.465689, 16.154226],
                [-90.06557, 40.099775, 16.154225],
                [-85.380613, 49.29452, 16.154225],
                [-79.760209, 57.949183, 16.154226],
                [-73.265935, 65.968943, 16.154225],
                [-65.968943, 73.265935, 16.154225],
                [-57.949183, 79.760209, 16.154226],
                [-49.29452, 85.380613, 16.154225],
                [-40.099775, 90.06557, 16.154225],
                [-30.465689, 93.763749, 16.154226],
                [-20.497814, 96.434632, 16.154225],
                [-10.305361, 98.048959, 16.154225],
                [0, 96.268323, 26.713189],
                [10.06278, 95.740956, 26.713189],
                [20.01531, 94.164631, 26.713189],
                [29.748548, 91.556616, 26.713189],
                [39.155855, 87.94549, 26.713189],
                [48.134162, 83.370815, 26.713189],
                [56.585101, 77.88271, 26.713189],
                [64.416082, 71.541307, 26.713189],
                [71.541307, 64.416082, 26.713189],
                [77.88271, 56.585101, 26.713189],
                [83.370815, 48.134162, 26.713189],
                [87.94549, 39.155855, 26.713189],
                [91.556616, 29.748548, 26.713189],
                [94.164631, 20.01531, 26.713189],
                [95.740956, 10.06278, 26.713189],
                [96.268323, 0, 26.713189],
                [95.740956, -10.06278, 26.713189],
                [94.164631, -20.01531, 26.713189],
                [91.556616, -29.748548, 26.713189],
                [87.94549, -39.155855, 26.713189],
                [83.370815, -48.134162, 26.713189],
                [77.88271, -56.585101, 26.713189],
                [71.541307, -64.416082, 26.713189],
                [64.416082, -71.541307, 26.713189],
                [56.585101, -77.88271, 26.713189],
                [48.134162, -83.370815, 26.713189],
                [39.155855, -87.94549, 26.713189],
                [29.748548, -91.556616, 26.713189],
                [20.01531, -94.164631, 26.713189],
                [10.06278, -95.740956, 26.713189],
                [0, -96.268323, 26.713189],
                [-10.06278, -95.740956, 26.713189],
                [-20.01531, -94.164631, 26.713189],
                [-29.748548, -91.556616, 26.713189],
                [-39.155855, -87.94549, 26.713189],
                [-48.134162, -83.370815, 26.713189],
                [-56.585101, -77.88271, 26.713189],
                [-64.416082, -71.541307, 26.713189],
                [-71.541307, -64.416082, 26.713189],
                [-77.88271, -56.585101, 26.713189],
                [-83.370815, -48.134162, 26.713189],
                [-87.94549, -39.155855, 26.713189],
                [-91.556616, -29.748548, 26.713189],
                [-94.164631, -20.01531, 26.713189],
                [-95.740956, -10.06278, 26.713189],
                [-96.268323, 0, 26.713189],
                [-95.740956, 10.06278, 26.713189],
                [-94.164631, 20.01531, 26.713189],
                [-91.556616, 29.748548, 26.713189],
                [-87.94549, 39.155855, 26.713189],
                [-83.370815, 48.134162, 26.713189],
                [-77.88271, 56.585101, 26.713189],
                [-71.541307, 64.416082, 26.713189],
                [-64.416082, 71.541307, 26.713189],
                [-56.585101, 77.88271, 26.713189],
                [-48.134162, 83.370815, 26.713189],
                [-39.155855, 87.94549, 26.713189],
                [-29.748548, 91.556616, 26.713189],
                [-20.01531, 94.164631, 26.713189],
                [-10.06278, 95.740956, 26.713189],
                [0, 92.821522, 36.958966],
                [9.702491, 92.313036, 36.958966],
                [19.29868, 90.793149, 36.958966],
                [28.683428, 88.278514, 36.958966],
                [37.753914, 84.79668, 36.958966],
                [46.410761, 80.385796, 36.958966],
                [54.559121, 75.094189, 36.958966],
                [62.109721, 68.979834, 36.958966],
                [68.979834, 62.109721, 36.958966],
                [75.094189, 54.559121, 36.958966],
                [80.385796, 46.410761, 36.958966],
                [84.79668, 37.753914, 36.958966],
                [88.278514, 28.683428, 36.958966],
                [90.793149, 19.29868, 36.958966],
                [92.313036, 9.702491, 36.958966],
                [92.821522, 0, 36.958966],
                [92.313036, -9.702491, 36.958966],
                [90.793149, -19.29868, 36.958966],
                [88.278514, -28.683428, 36.958966],
                [84.79668, -37.753914, 36.958966],
                [80.385796, -46.410761, 36.958966],
                [75.094189, -54.559121, 36.958966],
                [68.979834, -62.109721, 36.958966],
                [62.109721, -68.979834, 36.958966],
                [54.559121, -75.094189, 36.958966],
                [46.410761, -80.385796, 36.958966],
                [37.753914, -84.79668, 36.958966],
                [28.683428, -88.278514, 36.958966],
                [19.29868, -90.793149, 36.958966],
                [9.702491, -92.313036, 36.958966],
                [0, -92.821522, 36.958966],
                [-9.702491, -92.313036, 36.958966],
                [-19.29868, -90.793149, 36.958966],
                [-28.683428, -88.278514, 36.958966],
                [-37.753914, -84.79668, 36.958966],
                [-46.410761, -80.385796, 36.958966],
                [-54.559121, -75.094189, 36.958966],
                [-62.109721, -68.979834, 36.958966],
                [-68.979834, -62.109721, 36.958966],
                [-75.094189, -54.559121, 36.958966],
                [-80.385796, -46.410761, 36.958966],
                [-84.79668, -37.753914, 36.958966],
                [-88.278514, -28.683428, 36.958966],
                [-90.793149, -19.29868, 36.958966],
                [-92.313036, -9.702491, 36.958966],
                [-92.821522, 0, 36.958966],
                [-92.313036, 9.702491, 36.958966],
                [-90.793149, 19.29868, 36.958966],
                [-88.278514, 28.683428, 36.958966],
                [-84.79668, 37.753914, 36.958966],
                [-80.385796, 46.410761, 36.958966],
                [-75.094189, 54.559121, 36.958966],
                [-68.979834, 62.109721, 36.958966],
                [-62.109721, 68.979834, 36.958966],
                [-54.559121, 75.094189, 36.958966],
                [-46.410761, 80.385796, 36.958966],
                [-37.753914, 84.79668, 36.958966],
                [-28.683428, 88.278514, 36.958966],
                [-19.29868, 90.793149, 36.958966],
                [-9.702491, 92.313036, 36.958966],
                [0, 88.265941, 46.771431],
                [11.521017, 87.510814, 46.771431],
                [22.844907, 85.258352, 46.771431],
                [33.777914, 81.547096, 46.771431],
                [44.132971, 76.440547, 46.771431],
                [53.732901, 70.026079, 46.771431],
                [62.413445, 62.413445, 46.771431],
                [70.026079, 53.732901, 46.771431],
                [76.440547, 44.132971, 46.771431],
                [81.547096, 33.777914, 46.771431],
                [85.258352, 22.844907, 46.771431],
                [87.510814, 11.521017, 46.771431],
                [88.265941, 0, 46.771431],
                [87.510814, -11.521017, 46.771431],
                [85.258352, -22.844907, 46.771431],
                [81.547096, -33.777914, 46.771431],
                [76.440547, -44.132971, 46.771431],
                [70.026079, -53.732901, 46.771431],
                [62.413445, -62.413445, 46.771431],
                [53.732901, -70.026079, 46.771431],
                [44.132971, -76.440547, 46.771431],
                [33.777914, -81.547096, 46.771431],
                [22.844907, -85.258352, 46.771431],
                [11.521017, -87.510814, 46.771431],
                [0, -88.265941, 46.771431],
                [-11.521017, -87.510814, 46.771431],
                [-22.844907, -85.258352, 46.771431],
                [-33.777914, -81.547096, 46.771431],
                [-44.132971, -76.440547, 46.771431],
                [-53.732901, -70.026079, 46.771431],
                [-62.413445, -62.413445, 46.771431],
                [-70.026079, -53.732901, 46.771431],
                [-76.440547, -44.132971, 46.771431],
                [-81.547096, -33.777914, 46.771431],
                [-85.258352, -22.844907, 46.771431],
                [-87.510814, -11.521017, 46.771431],
                [-88.265941, 0, 46.771431],
                [-87.510814, 11.521017, 46.771431],
                [-85.258352, 22.844907, 46.771431],
                [-81.547096, 33.777914, 46.771431],
                [-76.440547, 44.132971, 46.771431],
                [-70.026079, 53.732901, 46.771431],
                [-62.413445, 62.413445, 46.771431],
                [-53.732901, 70.026079, 46.771431],
                [-44.132971, 76.440547, 46.771431],
                [-33.777914, 81.547096, 46.771431],
                [-22.844907, 85.258352, 46.771431],
                [-11.521017, 87.510814, 46.771431],
                [0, 82.703471, 56.035545],
                [10.794969, 81.995932, 56.035545],
                [21.405233, 79.885419, 56.035545],
                [31.649248, 76.408044, 56.035545],
                [41.351736, 71.623307, 56.035545],
                [50.346684, 65.613075, 56.035545],
                [58.480186, 58.480186, 56.035545],
                [65.613075, 50.346684, 56.035545],
                [71.623307, 41.351736, 56.035545],
                [76.408044, 31.649248, 56.035545],
                [79.885419, 21.405233, 56.035545],
                [81.995932, 10.794969, 56.035545],
                [82.703471, 0, 56.035545],
                [81.995932, -10.794969, 56.035545],
                [79.885419, -21.405233, 56.035545],
                [76.408044, -31.649248, 56.035545],
                [71.623307, -41.351736, 56.035545],
                [65.613075, -50.346684, 56.035545],
                [58.480186, -58.480186, 56.035545],
                [50.346684, -65.613075, 56.035545],
                [41.351736, -71.623307, 56.035545],
                [31.649248, -76.408044, 56.035545],
                [21.405233, -79.885419, 56.035545],
                [10.794969, -81.995932, 56.035545],
                [0, -82.703471, 56.035545],
                [-10.794969, -81.995932, 56.035545],
                [-21.405233, -79.885419, 56.035545],
                [-31.649248, -76.408044, 56.035545],
                [-41.351736, -71.623307, 56.035545],
                [-50.346684, -65.613075, 56.035545],
                [-58.480186, -58.480186, 56.035545],
                [-65.613075, -50.346684, 56.035545],
                [-71.623307, -41.351736, 56.035545],
                [-76.408044, -31.649248, 56.035545],
                [-79.885419, -21.405233, 56.035545],
                [-81.995932, -10.794969, 56.035545],
                [-82.703471, 0, 56.035545],
                [-81.995932, 10.794969, 56.035545],
                [-79.885419, 21.405233, 56.035545],
                [-76.408044, 31.649248, 56.035545],
                [-71.623307, 41.351736, 56.035545],
                [-65.613075, 50.346684, 56.035545],
                [-58.480186, 58.480186, 56.035545],
                [-50.346684, 65.613075, 56.035545],
                [-41.351736, 71.623307, 56.035545],
                [-31.649248, 76.408044, 56.035545],
                [-21.405233, 79.885419, 56.035545],
                [-10.794969, 81.995932, 56.035545],
                [0, 76.175454, 64.642694],
                [9.942892, 75.523762, 64.642693],
                [19.715658, 73.579839, 64.642693],
                [29.151084, 70.376943, 64.642693],
                [38.087727, 65.969879, 64.642693],
                [46.372678, 60.434051, 64.642693],
                [53.864181, 53.864181, 64.642692],
                [60.434051, 46.372678, 64.642693],
                [65.969879, 38.087727, 64.642693],
                [70.376943, 29.151084, 64.642693],
                [73.579839, 19.715658, 64.642693],
                [75.523762, 9.942892, 64.642693],
                [76.175454, 0, 64.642694],
                [75.523762, -9.942892, 64.642693],
                [73.579839, -19.715658, 64.642693],
                [70.376943, -29.151084, 64.642693],
                [65.969879, -38.087727, 64.642693],
                [60.434051, -46.372678, 64.642693],
                [53.864181, -53.864181, 64.642692],
                [46.372678, -60.434051, 64.642693],
                [38.087727, -65.969879, 64.642693],
                [29.151084, -70.376943, 64.642693],
                [19.715658, -73.579839, 64.642693],
                [9.942892, -75.523762, 64.642693],
                [0, -76.175454, 64.642694],
                [-9.942892, -75.523762, 64.642693],
                [-19.715658, -73.579839, 64.642693],
                [-29.151084, -70.376943, 64.642693],
                [-38.087727, -65.969879, 64.642693],
                [-46.372678, -60.434051, 64.642693],
                [-53.864181, -53.864181, 64.642692],
                [-60.434051, -46.372678, 64.642693],
                [-65.969879, -38.087727, 64.642693],
                [-70.376943, -29.151084, 64.642693],
                [-73.579839, -19.715658, 64.642693],
                [-75.523762, -9.942892, 64.642693],
                [-76.175454, 0, 64.642694],
                [-75.523762, 9.942892, 64.642693],
                [-73.579839, 19.715658, 64.642693],
                [-70.376943, 29.151084, 64.642693],
                [-65.969879, 38.087727, 64.642693],
                [-60.434051, 46.372678, 64.642693],
                [-53.864181, 53.864181, 64.642692],
                [-46.372678, 60.434051, 64.642693],
                [-38.087727, 65.969879, 64.642693],
                [-29.151084, 70.376943, 64.642693],
                [-19.715658, 73.579839, 64.642693],
                [-9.942892, 75.523762, 64.642693],
                [0, 68.759585, 72.491965],
                [8.974927, 68.171338, 72.491965],
                [17.796291, 66.416659, 72.491965],
                [26.313154, 63.525574, 72.491965],
                [34.379793, 59.547548, 72.491965],
                [41.858183, 54.550646, 72.491965],
                [48.62037, 48.62037, 72.491965],
                [54.550646, 41.858183, 72.491965],
                [59.547548, 34.379793, 72.491965],
                [63.525574, 26.313154, 72.491965],
                [66.416659, 17.796291, 72.491965],
                [68.171338, 8.974927, 72.491965],
                [68.759585, 0, 72.491965],
                [68.171338, -8.974927, 72.491965],
                [66.416659, -17.796291, 72.491965],
                [63.525574, -26.313154, 72.491965],
                [59.547548, -34.379793, 72.491965],
                [54.550646, -41.858183, 72.491965],
                [48.62037, -48.62037, 72.491965],
                [41.858183, -54.550646, 72.491965],
                [34.379793, -59.547548, 72.491965],
                [26.313154, -63.525574, 72.491965],
                [17.796291, -66.416659, 72.491965],
                [8.974927, -68.171338, 72.491965],
                [0, -68.759585, 72.491965],
                [-8.974927, -68.171338, 72.491965],
                [-17.796291, -66.416659, 72.491965],
                [-26.313154, -63.525574, 72.491965],
                [-34.379793, -59.547548, 72.491965],
                [-41.858183, -54.550646, 72.491965],
                [-48.62037, -48.62037, 72.491965],
                [-54.550646, -41.858183, 72.491965],
                [-59.547548, -34.379793, 72.491965],
                [-63.525574, -26.313154, 72.491965],
                [-66.416659, -17.796291, 72.491965],
                [-68.171338, -8.974927, 72.491965],
                [-68.759585, 0, 72.491965],
                [-68.171338, 8.974927, 72.491965],
                [-66.416659, 17.796291, 72.491965],
                [-63.525574, 26.313154, 72.491965],
                [-59.547548, 34.379793, 72.491965],
                [-54.550646, 41.858183, 72.491965],
                [-48.62037, 48.62037, 72.491965],
                [-41.858183, 54.550646, 72.491965],
                [-34.379793, 59.547548, 72.491965],
                [-26.313154, 63.525574, 72.491965],
                [-17.796291, 66.416659, 72.491965],
                [-8.974927, 68.171338, 72.491965],
                [0, 60.510059, 79.491334],
                [10.507461, 59.590775, 79.491333],
                [20.695659, 56.860856, 79.491334],
                [30.255029, 52.403248, 79.491334],
                [38.895116, 46.353394, 79.491334],
                [46.353394, 38.895116, 79.491334],
                [52.403248, 30.255029, 79.491334],
                [56.860856, 20.695659, 79.491334],
                [59.590775, 10.507461, 79.491333],
                [60.510059, 0, 79.491334],
                [59.590775, -10.507461, 79.491333],
                [56.860856, -20.695659, 79.491334],
                [52.403248, -30.255029, 79.491334],
                [46.353394, -38.895116, 79.491334],
                [38.895116, -46.353394, 79.491334],
                [30.255029, -52.403248, 79.491334],
                [20.695659, -56.860856, 79.491334],
                [10.507461, -59.590775, 79.491333],
                [0, -60.510059, 79.491334],
                [-10.507461, -59.590775, 79.491333],
                [-20.695659, -56.860856, 79.491334],
                [-30.255029, -52.403248, 79.491334],
                [-38.895116, -46.353394, 79.491334],
                [-46.353394, -38.895116, 79.491334],
                [-52.403248, -30.255029, 79.491334],
                [-56.860856, -20.695659, 79.491334],
                [-59.590775, -10.507461, 79.491333],
                [-60.510059, 0, 79.491334],
                [-59.590775, 10.507461, 79.491333],
                [-56.860856, 20.695659, 79.491334],
                [-52.403248, 30.255029, 79.491334],
                [-46.353394, 38.895116, 79.491334],
                [-38.895116, 46.353394, 79.491334],
                [-30.255029, 52.403248, 79.491334],
                [-20.695659, 56.860856, 79.491334],
                [-10.507461, 59.590775, 79.491333],
                [0, 51.601062, 85.558742],
                [8.96043, 50.817126, 85.558742],
                [17.648603, 48.489138, 85.558742],
                [25.800531, 44.687831, 85.558742],
                [33.168524, 39.528708, 85.558742],
                [39.528708, 33.168524, 85.558742],
                [44.687831, 25.800531, 85.558742],
                [48.489138, 17.648603, 85.558742],
                [50.817126, 8.96043, 85.558742],
                [51.601062, 0, 85.558742],
                [50.817126, -8.96043, 85.558742],
                [48.489138, -17.648603, 85.558742],
                [44.687831, -25.800531, 85.558742],
                [39.528708, -33.168524, 85.558742],
                [33.168524, -39.528708, 85.558742],
                [25.800531, -44.687831, 85.558742],
                [17.648603, -48.489138, 85.558742],
                [8.96043, -50.817126, 85.558742],
                [0, -51.601062, 85.558742],
                [-8.96043, -50.817126, 85.558742],
                [-17.648603, -48.489138, 85.558742],
                [-25.800531, -44.687831, 85.558742],
                [-33.168524, -39.528708, 85.558742],
                [-39.528708, -33.168524, 85.558742],
                [-44.687831, -25.800531, 85.558742],
                [-48.489138, -17.648603, 85.558742],
                [-50.817126, -8.96043, 85.558742],
                [-51.601062, 0, 85.558742],
                [-50.817126, 8.96043, 85.558742],
                [-48.489138, 17.648603, 85.558742],
                [-44.687831, 25.800531, 85.558742],
                [-39.528708, 33.168524, 85.558742],
                [-33.168524, 39.528708, 85.558742],
                [-25.800531, 44.687831, 85.558742],
                [-17.648603, 48.489138, 85.558742],
                [-8.96043, 50.817126, 85.558742],
                [0, 42.038342, 90.623053],
                [10.880323, 40.605919, 90.623053],
                [21.019171, 36.406271, 90.623053],
                [29.725596, 29.725596, 90.623053],
                [36.406271, 21.019171, 90.623053],
                [40.605919, 10.880323, 90.623053],
                [42.038342, 0, 90.623053],
                [40.605919, -10.880323, 90.623053],
                [36.406271, -21.019171, 90.623053],
                [29.725596, -29.725596, 90.623053],
                [21.019171, -36.406271, 90.623053],
                [10.880323, -40.605919, 90.623053],
                [0, -42.038342, 90.623053],
                [-10.880323, -40.605919, 90.623053],
                [-21.019171, -36.406271, 90.623053],
                [-29.725596, -29.725596, 90.623053],
                [-36.406271, -21.019171, 90.623053],
                [-40.605919, -10.880323, 90.623053],
                [-42.038342, 0, 90.623053],
                [-40.605919, 10.880323, 90.623053],
                [-36.406271, 21.019171, 90.623053],
                [-29.725596, 29.725596, 90.623053],
                [-21.019171, 36.406271, 90.623053],
                [-10.880323, 40.605919, 90.623053],
                [0, 32.096525, 94.624889],
                [8.307192, 31.002862, 94.62489],
                [16.048262, 27.796406, 94.624889],
                [22.69567, 22.69567, 94.62489],
                [27.796406, 16.048262, 94.624889],
                [31.002862, 8.307192, 94.62489],
                [32.096525, 0, 94.624889],
                [31.002862, -8.307192, 94.62489],
                [27.796406, -16.048262, 94.624889],
                [22.69567, -22.69567, 94.62489],
                [16.048262, -27.796406, 94.624889],
                [8.307192, -31.002862, 94.62489],
                [0, -32.096525, 94.624889],
                [-8.307192, -31.002862, 94.62489],
                [-16.048262, -27.796406, 94.624889],
                [-22.69567, -22.69567, 94.62489],
                [-27.796406, -16.048262, 94.624889],
                [-31.002862, -8.307192, 94.62489],
                [-32.096525, 0, 94.624889],
                [-31.002862, 8.307192, 94.62489],
                [-27.796406, 16.048262, 94.624889],
                [-22.69567, 22.69567, 94.62489],
                [-16.048262, 27.796406, 94.624889],
                [-8.307192, 31.002862, 94.62489],
                [0, 21.668599, 97.517335],
                [10.834299, 18.765557, 97.517335],
                [18.765557, 10.834299, 97.517335],
                [21.668599, 0, 97.517335],
                [18.765557, -10.834299, 97.517335],
                [10.834299, -18.765557, 97.517335],
                [0, -21.668599, 97.517335],
                [-10.834299, -18.765557, 97.517335],
                [-18.765557, -10.834299, 97.517335],
                [-21.668599, 0, 97.517335],
                [-18.765557, 10.834299, 97.517335],
                [-10.834299, 18.765557, 97.517335],
                [0, 11.566076, 99.26648],
                [5.783038, 10.016516, 99.26648],
                [10.016516, 5.783038, 99.26648],
                [11.566076, 0, 99.26648],
                [10.016516, -5.783038, 99.26648],
                [5.783038, -10.016516, 99.26648],
                [0, -11.566076, 99.26648],
                [-5.783038, -10.016516, 99.26648],
                [-10.016516, -5.783038, 99.26648],
                [-11.566076, 0, 99.26648],
                [-10.016516, 5.783038, 99.26648],
                [-5.783038, 10.016516, 99.26648],
                [0, 0, 99.925143],
            ]),
            "patch_vectors": np.array([
                [0.0, 0.99452200000000002, 0.104528],
                [0.20677300000000001, 0.97278900000000001, 0.104528],
                [0.40450799999999998, 0.90854100000000004, 0.104528],
                [0.584565, 0.80458499999999999, 0.104528],
                [0.73907400000000001, 0.66546499999999997, 0.104528],
                [0.86128099999999996, 0.49726100000000001, 0.104528],
                [0.94584699999999999, 0.30732399999999999, 0.104528],
                [0.98907400000000001, 0.10395600000000001, 0.104528],
                [0.98907400000000001, -0.10395600000000001, 0.104528],
                [0.94584699999999999, -0.30732399999999999, 0.104528],
                [0.86128099999999996, -0.49726100000000001, 0.104528],
                [0.73907400000000001, -0.66546499999999997, 0.104528],
                [0.584565, -0.80458499999999999, 0.104528],
                [0.40450799999999998, -0.90854100000000004, 0.104528],
                [0.20677300000000001, -0.97278900000000001, 0.104528],
                [0.0, -0.99452200000000002, 0.104528],
                [-0.20677300000000001, -0.97278900000000001, 0.104528],
                [-0.40450799999999998, -0.90854100000000004, 0.104528],
                [-0.584565, -0.80458499999999999, 0.104528],
                [-0.73907400000000001, -0.66546499999999997, 0.104528],
                [-0.86128099999999996, -0.49726100000000001, 0.104528],
                [-0.94584699999999999, -0.30732399999999999, 0.104528],
                [-0.98907400000000001, -0.10395600000000001, 0.104528],
                [-0.98907400000000001, 0.10395600000000001, 0.104528],
                [-0.94584699999999999, 0.30732399999999999, 0.104528],
                [-0.86128099999999996, 0.49726100000000001, 0.104528],
                [-0.73907400000000001, 0.66546499999999997, 0.104528],
                [-0.584565, 0.80458499999999999, 0.104528],
                [-0.40450799999999998, 0.90854100000000004, 0.104528],
                [-0.20677300000000001, 0.97278900000000001, 0.104528],
                [0.0, 0.95105700000000004, 0.30901699999999999],
                [0.197736, 0.93027400000000005, 0.30901699999999999],
                [0.38683000000000001, 0.86883299999999997, 0.30901699999999999],
                [0.55901699999999999, 0.76942100000000002, 0.30901699999999999],
                [0.70677299999999998, 0.63638099999999997, 0.30901699999999999],
                [0.82363900000000001, 0.47552800000000001, 0.30901699999999999],
                [0.90450799999999998, 0.29389300000000002, 0.30901699999999999],
                [0.94584699999999999, 0.099412, 0.30901699999999999],
                [0.94584699999999999, -0.099412, 0.30901699999999999],
                [0.90450799999999998, -0.29389300000000002, 0.30901699999999999],
                [0.82363900000000001, -0.47552800000000001, 0.30901699999999999],
                [0.70677299999999998, -0.63638099999999997, 0.30901699999999999],
                [0.55901699999999999, -0.76942100000000002, 0.30901699999999999],
                [0.38683000000000001, -0.86883299999999997, 0.30901699999999999],
                [0.197736, -0.93027400000000005, 0.30901699999999999],
                [0.0, -0.95105700000000004, 0.30901699999999999],
                [-0.197736, -0.93027400000000005, 0.30901699999999999],
                [-0.38683000000000001, -0.86883299999999997, 0.30901699999999999],
                [-0.55901699999999999, -0.76942100000000002, 0.30901699999999999],
                [-0.70677299999999998, -0.63638099999999997, 0.30901699999999999],
                [-0.82363900000000001, -0.47552800000000001, 0.30901699999999999],
                [-0.90450799999999998, -0.29389300000000002, 0.30901699999999999],
                [-0.94584699999999999, -0.099412, 0.30901699999999999],
                [-0.94584699999999999, 0.099412, 0.30901699999999999],
                [-0.90450799999999998, 0.29389300000000002, 0.30901699999999999],
                [-0.82363900000000001, 0.47552800000000001, 0.30901699999999999],
                [-0.70677299999999998, 0.63638099999999997, 0.30901699999999999],
                [-0.55901699999999999, 0.76942100000000002, 0.30901699999999999],
                [-0.38683000000000001, 0.86883299999999997, 0.30901699999999999],
                [-0.197736, 0.93027400000000005, 0.30901699999999999],
                [0.0, 0.86602500000000004, 0.5],
                [0.22414400000000001, 0.83651600000000004, 0.5],
                [0.43301299999999998, 0.75, 0.5],
                [0.61237200000000003, 0.61237200000000003, 0.5],
                [0.75, 0.43301299999999998, 0.5],
                [0.83651600000000004, 0.22414400000000001, 0.5],
                [0.86602500000000004, 0.0, 0.5],
                [0.83651600000000004, -0.22414400000000001, 0.5],
                [0.75, -0.43301299999999998, 0.5],
                [0.61237200000000003, -0.61237200000000003, 0.5],
                [0.43301299999999998, -0.75, 0.5],
                [0.22414400000000001, -0.83651600000000004, 0.5],
                [0.0, -0.86602500000000004, 0.5],
                [-0.22414400000000001, -0.83651600000000004, 0.5],
                [-0.43301299999999998, -0.75, 0.5],
                [-0.61237200000000003, -0.61237200000000003, 0.5],
                [-0.75, -0.43301299999999998, 0.5],
                [-0.83651600000000004, -0.22414400000000001, 0.5],
                [-0.86602500000000004, 0.0, 0.5],
                [-0.83651600000000004, 0.22414400000000001, 0.5],
                [-0.75, 0.43301299999999998, 0.5],
                [-0.61237200000000003, 0.61237200000000003, 0.5],
                [-0.43301299999999998, 0.75, 0.5],
                [-0.22414400000000001, 0.83651600000000004, 0.5],
                [0.0, 0.74314499999999994, 0.66913100000000003],
                [0.19234000000000001, 0.71782299999999999, 0.66913100000000003],
                [0.37157200000000001, 0.64358199999999999, 0.66913100000000003],
                [0.52548300000000003, 0.52548300000000003, 0.66913100000000003],
                [0.64358199999999999, 0.37157200000000001, 0.66913100000000003],
                [0.71782299999999999, 0.19234000000000001, 0.66913100000000003],
                [0.74314499999999994, 0.0, 0.66913100000000003],
                [0.71782299999999999, -0.19234000000000001, 0.66913100000000003],
                [0.64358199999999999, -0.37157200000000001, 0.66913100000000003],
                [0.52548300000000003, -0.52548300000000003, 0.66913100000000003],
                [0.37157200000000001, -0.64358199999999999, 0.66913100000000003],
                [0.19234000000000001, -0.71782299999999999, 0.66913100000000003],
                [0.0, -0.74314499999999994, 0.66913100000000003],
                [-0.19234000000000001, -0.71782299999999999, 0.66913100000000003],
                [-0.37157200000000001, -0.64358199999999999, 0.66913100000000003],
                [-0.52548300000000003, -0.52548300000000003, 0.66913100000000003],
                [-0.64358199999999999, -0.37157200000000001, 0.66913100000000003],
                [-0.71782299999999999, -0.19234000000000001, 0.66913100000000003],
                [-0.74314499999999994, 0.0, 0.66913100000000003],
                [-0.71782299999999999, 0.19234000000000001, 0.66913100000000003],
                [-0.64358199999999999, 0.37157200000000001, 0.66913100000000003],
                [-0.52548300000000003, 0.52548300000000003, 0.66913100000000003],
                [-0.37157200000000001, 0.64358199999999999, 0.66913100000000003],
                [-0.19234000000000001, 0.71782299999999999, 0.66913100000000003],
                [0.0, 0.587785, 0.80901699999999999],
                [0.20103399999999999, 0.55233699999999997, 0.80901699999999999],
                [0.37782100000000002, 0.45027, 0.80901699999999999],
                [0.50903699999999996, 0.29389300000000002, 0.80901699999999999],
                [0.57885500000000001, 0.10206800000000001, 0.80901699999999999],
                [0.57885500000000001, -0.10206800000000001, 0.80901699999999999],
                [0.50903699999999996, -0.29389300000000002, 0.80901699999999999],
                [0.37782100000000002, -0.45027, 0.80901699999999999],
                [0.20103399999999999, -0.55233699999999997, 0.80901699999999999],
                [0.0, -0.587785, 0.80901699999999999],
                [-0.20103399999999999, -0.55233699999999997, 0.80901699999999999],
                [-0.37782100000000002, -0.45027, 0.80901699999999999],
                [-0.50903699999999996, -0.29389300000000002, 0.80901699999999999],
                [-0.57885500000000001, -0.10206800000000001, 0.80901699999999999],
                [-0.57885500000000001, 0.10206800000000001, 0.80901699999999999],
                [-0.50903699999999996, 0.29389300000000002, 0.80901699999999999],
                [-0.37782100000000002, 0.45027, 0.80901699999999999],
                [-0.20103399999999999, 0.55233699999999997, 0.80901699999999999],
                [0.0, 0.40673700000000002, 0.91354500000000005],
                [0.20336799999999999, 0.352244, 0.91354500000000005],
                [0.352244, 0.20336799999999999, 0.91354500000000005],
                [0.40673700000000002, 0.0, 0.91354500000000005],
                [0.352244, -0.20336799999999999, 0.91354500000000005],
                [0.20336799999999999, -0.352244, 0.91354500000000005],
                [0.0, -0.40673700000000002, 0.91354500000000005],
                [-0.20336799999999999, -0.352244, 0.91354500000000005],
                [-0.352244, -0.20336799999999999, 0.91354500000000005],
                [-0.40673700000000002, 0.0, 0.91354500000000005],
                [-0.352244, 0.20336799999999999, 0.91354500000000005],
                [-0.20336799999999999, 0.352244, 0.91354500000000005],
                [0.0, 0.20791200000000001, 0.97814800000000002],
                [0.18005699999999999, 0.10395600000000001, 0.97814800000000002],
                [0.18005699999999999, -0.10395600000000001, 0.97814800000000002],
                [0.0, -0.20791200000000001, 0.97814800000000002],
                [-0.18005699999999999, -0.10395600000000001, 0.97814800000000002],
                [-0.18005699999999999, 0.10395600000000001, 0.97814800000000002],
                [0.0, 0.0, 1]
            ]),
            "patch_count": 145,
            "patch_conversion_factor": np.array([
                0.0435449227,
                0.0416418006,
                0.0473984151,
                0.0406730411,
                0.0428934136,
                0.0445221864,
                0.0455168385,
                0.0344199465
            ]),
            "patches_per_row": np.array([
                30,
                30,
                24,
                24,
                18,
                12,
                6,
                1,
            ]),
            "conversion_factor": np.array([
                0.04354492, 0.04354492, 0.04354492, 0.04354492, 0.04354492,
                0.04354492, 0.04354492, 0.04354492, 0.04354492, 0.04354492,
                0.04354492, 0.04354492, 0.04354492, 0.04354492, 0.04354492,
                0.04354492, 0.04354492, 0.04354492, 0.04354492, 0.04354492,
                0.04354492, 0.04354492, 0.04354492, 0.04354492, 0.04354492,
                0.04354492, 0.04354492, 0.04354492, 0.04354492, 0.04354492,
                0.0416418 , 0.0416418 , 0.0416418 , 0.0416418 , 0.0416418 ,
                0.0416418 , 0.0416418 , 0.0416418 , 0.0416418 , 0.0416418 ,
                0.0416418 , 0.0416418 , 0.0416418 , 0.0416418 , 0.0416418 ,
                0.0416418 , 0.0416418 , 0.0416418 , 0.0416418 , 0.0416418 ,
                0.0416418 , 0.0416418 , 0.0416418 , 0.0416418 , 0.0416418 ,
                0.0416418 , 0.0416418 , 0.0416418 , 0.0416418 , 0.0416418 ,
                0.04739842, 0.04739842, 0.04739842, 0.04739842, 0.04739842,
                0.04739842, 0.04739842, 0.04739842, 0.04739842, 0.04739842,
                0.04739842, 0.04739842, 0.04739842, 0.04739842, 0.04739842,
                0.04739842, 0.04739842, 0.04739842, 0.04739842, 0.04739842,
                0.04739842, 0.04739842, 0.04739842, 0.04739842, 0.04067304,
                0.04067304, 0.04067304, 0.04067304, 0.04067304, 0.04067304,
                0.04067304, 0.04067304, 0.04067304, 0.04067304, 0.04067304,
                0.04067304, 0.04067304, 0.04067304, 0.04067304, 0.04067304,
                0.04067304, 0.04067304, 0.04067304, 0.04067304, 0.04067304,
                0.04067304, 0.04067304, 0.04067304, 0.04289341, 0.04289341,
                0.04289341, 0.04289341, 0.04289341, 0.04289341, 0.04289341,
                0.04289341, 0.04289341, 0.04289341, 0.04289341, 0.04289341,
                0.04289341, 0.04289341, 0.04289341, 0.04289341, 0.04289341,
                0.04289341, 0.04452219, 0.04452219, 0.04452219, 0.04452219,
                0.04452219, 0.04452219, 0.04452219, 0.04452219, 0.04452219,
                0.04452219, 0.04452219, 0.04452219, 0.04551684, 0.04551684,
                0.04551684, 0.04551684, 0.04551684, 0.04551684, 0.03441995
            ]),
        }
        self.reinhart_sky_dome = {
            "patch_centroids": np.array([
                [0, 0.997474, 0.054056],
                [0.104264, 0.99201, 0.054056],
                [0.207387, 0.975677, 0.054056],
                [0.308237, 0.948654, 0.054056],
                [0.405709, 0.911238, 0.054056],
                [0.498737, 0.863838, 0.054056],
                [0.586301, 0.806974, 0.054056],
                [0.667441, 0.741268, 0.054056],
                [0.741268, 0.667441, 0.054056],
                [0.806974, 0.586301, 0.054056],
                [0.863838, 0.498737, 0.054056],
                [0.911238, 0.405709, 0.054056],
                [0.948654, 0.308237, 0.054056],
                [0.975677, 0.207387, 0.054056],
                [0.99201, 0.104264, 0.054056],
                [0.997474, 0, 0.054056],
                [0.99201, -0.104264, 0.054056],
                [0.975677, -0.207387, 0.054056],
                [0.948654, -0.308237, 0.054056],
                [0.911238, -0.405709, 0.054056],
                [0.863838, -0.498737, 0.054056],
                [0.806974, -0.586301, 0.054056],
                [0.741268, -0.667441, 0.054056],
                [0.667441, -0.741268, 0.054056],
                [0.586301, -0.806974, 0.054056],
                [0.498737, -0.863838, 0.054056],
                [0.405709, -0.911238, 0.054056],
                [0.308237, -0.948654, 0.054056],
                [0.207387, -0.975677, 0.054056],
                [0.104264, -0.99201, 0.054056],
                [0, -0.997474, 0.054056],
                [-0.104264, -0.99201, 0.054056],
                [-0.207387, -0.975677, 0.054056],
                [-0.308237, -0.948654, 0.054056],
                [-0.405709, -0.911238, 0.054056],
                [-0.498737, -0.863838, 0.054056],
                [-0.586301, -0.806974, 0.054056],
                [-0.667441, -0.741268, 0.054056],
                [-0.741268, -0.667441, 0.054056],
                [-0.806974, -0.586301, 0.054056],
                [-0.863838, -0.498737, 0.054056],
                [-0.911238, -0.405709, 0.054056],
                [-0.948654, -0.308237, 0.054056],
                [-0.975677, -0.207387, 0.054056],
                [-0.99201, -0.104264, 0.054056],
                [-0.997474, 0, 0.054056],
                [-0.99201, 0.104264, 0.054056],
                [-0.975677, 0.207387, 0.054056],
                [-0.948654, 0.308237, 0.054056],
                [-0.911238, 0.405709, 0.054056],
                [-0.863838, 0.498737, 0.054056],
                [-0.806974, 0.586301, 0.054056],
                [-0.741268, 0.667441, 0.054056],
                [-0.667441, 0.741268, 0.054056],
                [-0.586301, 0.806974, 0.054056],
                [-0.498737, 0.863838, 0.054056],
                [-0.405709, 0.911238, 0.054056],
                [-0.308237, 0.948654, 0.054056],
                [-0.207387, 0.975677, 0.054056],
                [-0.104264, 0.99201, 0.054056],
                [0, 0.985803, 0.161535],
                [0.103044, 0.980403, 0.161535],
                [0.20496, 0.964261, 0.161535],
                [0.30463, 0.937554, 0.161535],
                [0.400962, 0.900576, 0.161535],
                [0.492901, 0.85373, 0.161535],
                [0.57944, 0.797531, 0.161535],
                [0.659631, 0.732594, 0.161535],
                [0.732594, 0.659631, 0.161535],
                [0.797531, 0.57944, 0.161535],
                [0.85373, 0.492901, 0.161535],
                [0.900576, 0.400962, 0.161535],
                [0.937554, 0.30463, 0.161535],
                [0.964261, 0.20496, 0.161535],
                [0.980403, 0.103044, 0.161535],
                [0.985803, 0, 0.161535],
                [0.980403, -0.103044, 0.161535],
                [0.964261, -0.20496, 0.161535],
                [0.937554, -0.30463, 0.161535],
                [0.900576, -0.400962, 0.161535],
                [0.85373, -0.492901, 0.161535],
                [0.797531, -0.57944, 0.161535],
                [0.732594, -0.659631, 0.161535],
                [0.659631, -0.732594, 0.161535],
                [0.57944, -0.797531, 0.161535],
                [0.492901, -0.85373, 0.161535],
                [0.400962, -0.900576, 0.161535],
                [0.30463, -0.937554, 0.161535],
                [0.20496, -0.964261, 0.161535],
                [0.103044, -0.980403, 0.161535],
                [0, -0.985803, 0.161535],
                [-0.103044, -0.980403, 0.161535],
                [-0.20496, -0.964261, 0.161535],
                [-0.30463, -0.937554, 0.161535],
                [-0.400962, -0.900576, 0.161535],
                [-0.492901, -0.85373, 0.161535],
                [-0.57944, -0.797531, 0.161535],
                [-0.659631, -0.732594, 0.161535],
                [-0.732594, -0.659631, 0.161535],
                [-0.797531, -0.57944, 0.161535],
                [-0.85373, -0.492901, 0.161535],
                [-0.900576, -0.400962, 0.161535],
                [-0.937554, -0.30463, 0.161535],
                [-0.964261, -0.20496, 0.161535],
                [-0.980403, -0.103044, 0.161535],
                [-0.985803, 0, 0.161535],
                [-0.980403, 0.103044, 0.161535],
                [-0.964261, 0.20496, 0.161535],
                [-0.937554, 0.30463, 0.161535],
                [-0.900576, 0.400962, 0.161535],
                [-0.85373, 0.492901, 0.161535],
                [-0.797531, 0.57944, 0.161535],
                [-0.732594, 0.659631, 0.161535],
                [-0.659631, 0.732594, 0.161535],
                [-0.57944, 0.797531, 0.161535],
                [-0.492901, 0.85373, 0.161535],
                [-0.400962, 0.900576, 0.161535],
                [-0.30463, 0.937554, 0.161535],
                [-0.20496, 0.964261, 0.161535],
                [-0.103044, 0.980403, 0.161535],
                [0, 0.962598, 0.26712],
                [0.100619, 0.957325, 0.26712],
                [0.200135, 0.941563, 0.26712],
                [0.297459, 0.915485, 0.26712],
                [0.391524, 0.879377, 0.26712],
                [0.481299, 0.833634, 0.26712],
                [0.565801, 0.778758, 0.26712],
                [0.644104, 0.71535, 0.26712],
                [0.71535, 0.644104, 0.26712],
                [0.778758, 0.565801, 0.26712],
                [0.833634, 0.481299, 0.26712],
                [0.879377, 0.391524, 0.26712],
                [0.915485, 0.297459, 0.26712],
                [0.941563, 0.200135, 0.26712],
                [0.957325, 0.100619, 0.26712],
                [0.962598, 0, 0.26712],
                [0.957325, -0.100619, 0.26712],
                [0.941563, -0.200135, 0.26712],
                [0.915485, -0.297459, 0.26712],
                [0.879377, -0.391524, 0.26712],
                [0.833634, -0.481299, 0.26712],
                [0.778758, -0.565801, 0.26712],
                [0.71535, -0.644104, 0.26712],
                [0.644104, -0.71535, 0.26712],
                [0.565801, -0.778758, 0.26712],
                [0.481299, -0.833634, 0.26712],
                [0.391524, -0.879377, 0.26712],
                [0.297459, -0.915485, 0.26712],
                [0.200135, -0.941563, 0.26712],
                [0.100619, -0.957325, 0.26712],
                [0, -0.962598, 0.26712],
                [-0.100619, -0.957325, 0.26712],
                [-0.200135, -0.941563, 0.26712],
                [-0.297459, -0.915485, 0.26712],
                [-0.391524, -0.879377, 0.26712],
                [-0.481299, -0.833634, 0.26712],
                [-0.565801, -0.778758, 0.26712],
                [-0.644104, -0.71535, 0.26712],
                [-0.71535, -0.644104, 0.26712],
                [-0.778758, -0.565801, 0.26712],
                [-0.833634, -0.481299, 0.26712],
                [-0.879377, -0.391524, 0.26712],
                [-0.915485, -0.297459, 0.26712],
                [-0.941563, -0.200135, 0.26712],
                [-0.957325, -0.100619, 0.26712],
                [-0.962598, 0, 0.26712],
                [-0.957325, 0.100619, 0.26712],
                [-0.941563, 0.200135, 0.26712],
                [-0.915485, 0.297459, 0.26712],
                [-0.879377, 0.391524, 0.26712],
                [-0.833634, 0.481299, 0.26712],
                [-0.778758, 0.565801, 0.26712],
                [-0.71535, 0.644104, 0.26712],
                [-0.644104, 0.71535, 0.26712],
                [-0.565801, 0.778758, 0.26712],
                [-0.481299, 0.833634, 0.26712],
                [-0.391524, 0.879377, 0.26712],
                [-0.297459, 0.915485, 0.26712],
                [-0.200135, 0.941563, 0.26712],
                [-0.100619, 0.957325, 0.26712],
                [0, 0.928133, 0.369573],
                [0.097016, 0.923049, 0.369573],
                [0.19297, 0.907851, 0.369573],
                [0.286809, 0.882707, 0.369573],
                [0.377506, 0.847892, 0.369573],
                [0.464066, 0.803787, 0.369573],
                [0.545543, 0.750875, 0.369573],
                [0.621042, 0.689737, 0.369573],
                [0.689737, 0.621042, 0.369573],
                [0.750875, 0.545543, 0.369573],
                [0.803787, 0.464066, 0.369573],
                [0.847892, 0.377506, 0.369573],
                [0.882707, 0.286809, 0.369573],
                [0.907851, 0.19297, 0.369573],
                [0.923049, 0.097016, 0.369573],
                [0.928133, 0, 0.369573],
                [0.923049, -0.097016, 0.369573],
                [0.907851, -0.19297, 0.369573],
                [0.882707, -0.286809, 0.369573],
                [0.847892, -0.377506, 0.369573],
                [0.803787, -0.464066, 0.369573],
                [0.750875, -0.545543, 0.369573],
                [0.689737, -0.621042, 0.369573],
                [0.621042, -0.689737, 0.369573],
                [0.545543, -0.750875, 0.369573],
                [0.464066, -0.803787, 0.369573],
                [0.377506, -0.847892, 0.369573],
                [0.286809, -0.882707, 0.369573],
                [0.19297, -0.907851, 0.369573],
                [0.097016, -0.923049, 0.369573],
                [0, -0.928133, 0.369573],
                [-0.097016, -0.923049, 0.369573],
                [-0.19297, -0.907851, 0.369573],
                [-0.286809, -0.882707, 0.369573],
                [-0.377506, -0.847892, 0.369573],
                [-0.464066, -0.803787, 0.369573],
                [-0.545543, -0.750875, 0.369573],
                [-0.621042, -0.689737, 0.369573],
                [-0.689737, -0.621042, 0.369573],
                [-0.750875, -0.545543, 0.369573],
                [-0.803787, -0.464066, 0.369573],
                [-0.847892, -0.377506, 0.369573],
                [-0.882707, -0.286809, 0.369573],
                [-0.907851, -0.19297, 0.369573],
                [-0.923049, -0.097016, 0.369573],
                [-0.928133, 0, 0.369573],
                [-0.923049, 0.097016, 0.369573],
                [-0.907851, 0.19297, 0.369573],
                [-0.882707, 0.286809, 0.369573],
                [-0.847892, 0.377506, 0.369573],
                [-0.803787, 0.464066, 0.369573],
                [-0.750875, 0.545543, 0.369573],
                [-0.689737, 0.621042, 0.369573],
                [-0.621042, 0.689737, 0.369573],
                [-0.545543, 0.750875, 0.369573],
                [-0.464066, 0.803787, 0.369573],
                [-0.377506, 0.847892, 0.369573],
                [-0.286809, 0.882707, 0.369573],
                [-0.19297, 0.907851, 0.369573],
                [-0.097016, 0.923049, 0.369573],
                [0, 0.882619, 0.467693],
                [0.115205, 0.875068, 0.467693],
                [0.228439, 0.852544, 0.467693],
                [0.337764, 0.815434, 0.467693],
                [0.441309, 0.76437, 0.467693],
                [0.537304, 0.700229, 0.467693],
                [0.624106, 0.624106, 0.467693],
                [0.700229, 0.537304, 0.467693],
                [0.76437, 0.441309, 0.467693],
                [0.815434, 0.337764, 0.467693],
                [0.852544, 0.228439, 0.467693],
                [0.875068, 0.115205, 0.467693],
                [0.882619, 0, 0.467693],
                [0.875068, -0.115205, 0.467693],
                [0.852544, -0.228439, 0.467693],
                [0.815434, -0.337764, 0.467693],
                [0.76437, -0.441309, 0.467693],
                [0.700229, -0.537304, 0.467693],
                [0.624106, -0.624106, 0.467693],
                [0.537304, -0.700229, 0.467693],
                [0.441309, -0.76437, 0.467693],
                [0.337764, -0.815434, 0.467693],
                [0.228439, -0.852544, 0.467693],
                [0.115205, -0.875068, 0.467693],
                [0, -0.882619, 0.467693],
                [-0.115205, -0.875068, 0.467693],
                [-0.228439, -0.852544, 0.467693],
                [-0.337764, -0.815434, 0.467693],
                [-0.441309, -0.76437, 0.467693],
                [-0.537304, -0.700229, 0.467693],
                [-0.624106, -0.624106, 0.467693],
                [-0.700229, -0.537304, 0.467693],
                [-0.76437, -0.441309, 0.467693],
                [-0.815434, -0.337764, 0.467693],
                [-0.852544, -0.228439, 0.467693],
                [-0.875068, -0.115205, 0.467693],
                [-0.882619, 0, 0.467693],
                [-0.875068, 0.115205, 0.467693],
                [-0.852544, 0.228439, 0.467693],
                [-0.815434, 0.337764, 0.467693],
                [-0.76437, 0.441309, 0.467693],
                [-0.700229, 0.537304, 0.467693],
                [-0.624106, 0.624106, 0.467693],
                [-0.537304, 0.700229, 0.467693],
                [-0.441309, 0.76437, 0.467693],
                [-0.337764, 0.815434, 0.467693],
                [-0.228439, 0.852544, 0.467693],
                [-0.115205, 0.875068, 0.467693],
                [0, 0.826997, 0.56033],
                [0.107945, 0.819922, 0.56033],
                [0.214043, 0.798818, 0.56033],
                [0.316478, 0.764045, 0.56033],
                [0.413498, 0.7162, 0.56033],
                [0.503444, 0.656101, 0.56033],
                [0.584775, 0.584775, 0.56033],
                [0.656101, 0.503444, 0.56033],
                [0.7162, 0.413498, 0.56033],
                [0.764045, 0.316478, 0.56033],
                [0.798818, 0.214043, 0.56033],
                [0.819922, 0.107945, 0.56033],
                [0.826997, 0, 0.56033],
                [0.819922, -0.107945, 0.56033],
                [0.798818, -0.214043, 0.56033],
                [0.764045, -0.316478, 0.56033],
                [0.7162, -0.413498, 0.56033],
                [0.656101, -0.503444, 0.56033],
                [0.584775, -0.584775, 0.56033],
                [0.503444, -0.656101, 0.56033],
                [0.413498, -0.7162, 0.56033],
                [0.316478, -0.764045, 0.56033],
                [0.214043, -0.798818, 0.56033],
                [0.107945, -0.819922, 0.56033],
                [0, -0.826997, 0.56033],
                [-0.107945, -0.819922, 0.56033],
                [-0.214043, -0.798818, 0.56033],
                [-0.316478, -0.764045, 0.56033],
                [-0.413498, -0.7162, 0.56033],
                [-0.503444, -0.656101, 0.56033],
                [-0.584775, -0.584775, 0.56033],
                [-0.656101, -0.503444, 0.56033],
                [-0.7162, -0.413498, 0.56033],
                [-0.764045, -0.316478, 0.56033],
                [-0.798818, -0.214043, 0.56033],
                [-0.819922, -0.107945, 0.56033],
                [-0.826997, 0, 0.56033],
                [-0.819922, 0.107945, 0.56033],
                [-0.798818, 0.214043, 0.56033],
                [-0.764045, 0.316478, 0.56033],
                [-0.7162, 0.413498, 0.56033],
                [-0.656101, 0.503444, 0.56033],
                [-0.584775, 0.584775, 0.56033],
                [-0.503444, 0.656101, 0.56033],
                [-0.413498, 0.7162, 0.56033],
                [-0.316478, 0.764045, 0.56033],
                [-0.214043, 0.798818, 0.56033],
                [-0.107945, 0.819922, 0.56033],
                [0, 0.76172, 0.646397],
                [0.099424, 0.755203, 0.646397],
                [0.197148, 0.735765, 0.646397],
                [0.291497, 0.703737, 0.646397],
                [0.38086, 0.659669, 0.646397],
                [0.463706, 0.604313, 0.646397],
                [0.538617, 0.538617, 0.646397],
                [0.604313, 0.463706, 0.646397],
                [0.659669, 0.38086, 0.646397],
                [0.703737, 0.291497, 0.646397],
                [0.735765, 0.197148, 0.646397],
                [0.755203, 0.099424, 0.646397],
                [0.76172, 0, 0.646397],
                [0.755203, -0.099424, 0.646397],
                [0.735765, -0.197148, 0.646397],
                [0.703737, -0.291497, 0.646397],
                [0.659669, -0.38086, 0.646397],
                [0.604313, -0.463706, 0.646397],
                [0.538617, -0.538617, 0.646397],
                [0.463706, -0.604313, 0.646397],
                [0.38086, -0.659669, 0.646397],
                [0.291497, -0.703737, 0.646397],
                [0.197148, -0.735765, 0.646397],
                [0.099424, -0.755203, 0.646397],
                [0, -0.76172, 0.646397],
                [-0.099424, -0.755203, 0.646397],
                [-0.197148, -0.735765, 0.646397],
                [-0.291497, -0.703737, 0.646397],
                [-0.38086, -0.659669, 0.646397],
                [-0.463706, -0.604313, 0.646397],
                [-0.538617, -0.538617, 0.646397],
                [-0.604313, -0.463706, 0.646397],
                [-0.659669, -0.38086, 0.646397],
                [-0.703737, -0.291497, 0.646397],
                [-0.735765, -0.197148, 0.646397],
                [-0.755203, -0.099424, 0.646397],
                [-0.76172, 0, 0.646397],
                [-0.755203, 0.099424, 0.646397],
                [-0.735765, 0.197148, 0.646397],
                [-0.703737, 0.291497, 0.646397],
                [-0.659669, 0.38086, 0.646397],
                [-0.604313, 0.463706, 0.646397],
                [-0.538617, 0.538617, 0.646397],
                [-0.463706, 0.604313, 0.646397],
                [-0.38086, 0.659669, 0.646397],
                [-0.291497, 0.703737, 0.646397],
                [-0.197148, 0.735765, 0.646397],
                [-0.099424, 0.755203, 0.646397],
                [0, 0.687518, 0.724886],
                [0.089739, 0.681637, 0.724886],
                [0.177943, 0.664092, 0.724886],
                [0.263102, 0.635184, 0.724886],
                [0.343759, 0.595408, 0.724886],
                [0.418535, 0.545445, 0.724886],
                [0.486149, 0.486149, 0.724886],
                [0.545445, 0.418535, 0.724886],
                [0.595408, 0.343759, 0.724886],
                [0.635184, 0.263102, 0.724886],
                [0.664092, 0.177943, 0.724886],
                [0.681637, 0.089739, 0.724886],
                [0.687518, 0, 0.724886],
                [0.681637, -0.089739, 0.724886],
                [0.664092, -0.177943, 0.724886],
                [0.635184, -0.263102, 0.724886],
                [0.595408, -0.343759, 0.724886],
                [0.545445, -0.418535, 0.724886],
                [0.486149, -0.486149, 0.724886],
                [0.418535, -0.545445, 0.724886],
                [0.343759, -0.595408, 0.724886],
                [0.263102, -0.635184, 0.724886],
                [0.177943, -0.664092, 0.724886],
                [0.089739, -0.681637, 0.724886],
                [0, -0.687518, 0.724886],
                [-0.089739, -0.681637, 0.724886],
                [-0.177943, -0.664092, 0.724886],
                [-0.263102, -0.635184, 0.724886],
                [-0.343759, -0.595408, 0.724886],
                [-0.418535, -0.545445, 0.724886],
                [-0.486149, -0.486149, 0.724886],
                [-0.545445, -0.418535, 0.724886],
                [-0.595408, -0.343759, 0.724886],
                [-0.635184, -0.263102, 0.724886],
                [-0.664092, -0.177943, 0.724886],
                [-0.681637, -0.089739, 0.724886],
                [-0.687518, 0, 0.724886],
                [-0.681637, 0.089739, 0.724886],
                [-0.664092, 0.177943, 0.724886],
                [-0.635184, 0.263102, 0.724886],
                [-0.595408, 0.343759, 0.724886],
                [-0.545445, 0.418535, 0.724886],
                [-0.486149, 0.486149, 0.724886],
                [-0.418535, 0.545445, 0.724886],
                [-0.343759, 0.595408, 0.724886],
                [-0.263102, 0.635184, 0.724886],
                [-0.177943, 0.664092, 0.724886],
                [-0.089739, 0.681637, 0.724886],
                [0, 0.605073, 0.794877],
                [0.10507, 0.59588, 0.794877],
                [0.206947, 0.568582, 0.794877],
                [0.302536, 0.524008, 0.794877],
                [0.388933, 0.463513, 0.794877],
                [0.463513, 0.388933, 0.794877],
                [0.524008, 0.302536, 0.794877],
                [0.568582, 0.206947, 0.794877],
                [0.59588, 0.10507, 0.794877],
                [0.605073, 0, 0.794877],
                [0.59588, -0.10507, 0.794877],
                [0.568582, -0.206947, 0.794877],
                [0.524008, -0.302536, 0.794877],
                [0.463513, -0.388933, 0.794877],
                [0.388933, -0.463513, 0.794877],
                [0.302536, -0.524008, 0.794877],
                [0.206947, -0.568582, 0.794877],
                [0.10507, -0.59588, 0.794877],
                [0, -0.605073, 0.794877],
                [-0.10507, -0.59588, 0.794877],
                [-0.206947, -0.568582, 0.794877],
                [-0.302536, -0.524008, 0.794877],
                [-0.388933, -0.463513, 0.794877],
                [-0.463513, -0.388933, 0.794877],
                [-0.524008, -0.302536, 0.794877],
                [-0.568582, -0.206947, 0.794877],
                [-0.59588, -0.10507, 0.794877],
                [-0.605073, 0, 0.794877],
                [-0.59588, 0.10507, 0.794877],
                [-0.568582, 0.206947, 0.794877],
                [-0.524008, 0.302536, 0.794877],
                [-0.463513, 0.388933, 0.794877],
                [-0.388933, 0.463513, 0.794877],
                [-0.302536, 0.524008, 0.794877],
                [-0.206947, 0.568582, 0.794877],
                [-0.10507, 0.59588, 0.794877],
                [0, 0.515987, 0.855548],
                [0.0896, 0.508148, 0.855548],
                [0.176478, 0.484869, 0.855548],
                [0.257993, 0.446858, 0.855548],
                [0.33167, 0.395269, 0.855548],
                [0.395269, 0.33167, 0.855548],
                [0.446858, 0.257993, 0.855548],
                [0.484869, 0.176478, 0.855548],
                [0.508148, 0.0896, 0.855548],
                [0.515987, 0, 0.855548],
                [0.508148, -0.0896, 0.855548],
                [0.484869, -0.176478, 0.855548],
                [0.446858, -0.257993, 0.855548],
                [0.395269, -0.33167, 0.855548],
                [0.33167, -0.395269, 0.855548],
                [0.257993, -0.446858, 0.855548],
                [0.176478, -0.484869, 0.855548],
                [0.0896, -0.508148, 0.855548],
                [0, -0.515987, 0.855548],
                [-0.0896, -0.508148, 0.855548],
                [-0.176478, -0.484869, 0.855548],
                [-0.257993, -0.446858, 0.855548],
                [-0.33167, -0.395269, 0.855548],
                [-0.395269, -0.33167, 0.855548],
                [-0.446858, -0.257993, 0.855548],
                [-0.484869, -0.176478, 0.855548],
                [-0.508148, -0.0896, 0.855548],
                [-0.515987, 0, 0.855548],
                [-0.508148, 0.0896, 0.855548],
                [-0.484869, 0.176478, 0.855548],
                [-0.446858, 0.257993, 0.855548],
                [-0.395269, 0.33167, 0.855548],
                [-0.33167, 0.395269, 0.855548],
                [-0.257993, 0.446858, 0.855548],
                [-0.176478, 0.484869, 0.855548],
                [-0.0896, 0.508148, 0.855548],
                [0, 0.420336, 0.906189],
                [0.108791, 0.406013, 0.906189],
                [0.210168, 0.364022, 0.906189],
                [0.297222, 0.297222, 0.906189],
                [0.364022, 0.210168, 0.906189],
                [0.406013, 0.108791, 0.906189],
                [0.420336, 0, 0.906189],
                [0.406013, -0.108791, 0.906189],
                [0.364022, -0.210168, 0.906189],
                [0.297222, -0.297222, 0.906189],
                [0.210168, -0.364022, 0.906189],
                [0.108791, -0.406013, 0.906189],
                [0, -0.420336, 0.906189],
                [-0.108791, -0.406013, 0.906189],
                [-0.210168, -0.364022, 0.906189],
                [-0.297222, -0.297222, 0.906189],
                [-0.364022, -0.210168, 0.906189],
                [-0.406013, -0.108791, 0.906189],
                [-0.420336, 0, 0.906189],
                [-0.406013, 0.108791, 0.906189],
                [-0.364022, 0.210168, 0.906189],
                [-0.297222, 0.297222, 0.906189],
                [-0.210168, 0.364022, 0.906189],
                [-0.108791, 0.406013, 0.906189],
                [0, 0.320929, 0.946205],
                [0.083063, 0.309994, 0.946205],
                [0.160465, 0.277933, 0.946205],
                [0.226931, 0.226931, 0.946205],
                [0.277933, 0.160465, 0.946205],
                [0.309994, 0.083063, 0.946205],
                [0.320929, 0, 0.946205],
                [0.309994, -0.083063, 0.946205],
                [0.277933, -0.160465, 0.946205],
                [0.226931, -0.226931, 0.946205],
                [0.160465, -0.277933, 0.946205],
                [0.083063, -0.309994, 0.946205],
                [0, -0.320929, 0.946205],
                [-0.083063, -0.309994, 0.946205],
                [-0.160465, -0.277933, 0.946205],
                [-0.226931, -0.226931, 0.946205],
                [-0.277933, -0.160465, 0.946205],
                [-0.309994, -0.083063, 0.946205],
                [-0.320929, 0, 0.946205],
                [-0.309994, 0.083063, 0.946205],
                [-0.277933, 0.160465, 0.946205],
                [-0.226931, 0.226931, 0.946205],
                [-0.160465, 0.277933, 0.946205],
                [-0.083063, 0.309994, 0.946205],
                [0, 0.216676, 0.975129],
                [0.108338, 0.187647, 0.975129],
                [0.187647, 0.108338, 0.975129],
                [0.216676, 0, 0.975129],
                [0.187647, -0.108338, 0.975129],
                [0.108338, -0.187647, 0.975129],
                [0, -0.216676, 0.975129],
                [-0.108338, -0.187647, 0.975129],
                [-0.187647, -0.108338, 0.975129],
                [-0.216676, 0, 0.975129],
                [-0.187647, 0.108338, 0.975129],
                [-0.108338, 0.187647, 0.975129],
                [0, 0.115625, 0.992619],
                [0.057812, 0.100134, 0.992619],
                [0.100134, 0.057812, 0.992619],
                [0.115625, 0, 0.992619],
                [0.100134, -0.057812, 0.992619],
                [0.057812, -0.100134, 0.992619],
                [0, -0.115625, 0.992619],
                [-0.057812, -0.100134, 0.992619],
                [-0.100134, -0.057812, 0.992619],
                [-0.115625, 0, 0.992619],
                [-0.100134, 0.057812, 0.992619],
                [-0.057812, 0.100134, 0.992619],
                [0, 0, 0.999251],
            ]),
            "patch_vectors": np.array([
                [-0.0000000, 0.9985349, 0.0541114],
                [0.1043753, 0.9930648, 0.0541114],
                [0.2076071, 0.9767145, 0.0541114],
                [0.3085643, 0.9496631, 0.0541114],
                [0.4061407, 0.9122070, 0.0541114],
                [0.4992675, 0.8647566, 0.0541114],
                [0.5869241, 0.8078317, 0.0541114],
                [0.6681503, 0.7420561, 0.0541114],
                [0.7420561, 0.6681503, 0.0541114],
                [0.8078317, 0.5869241, 0.0541114],
                [0.8647566, 0.4992675, 0.0541114],
                [0.9122070, 0.4061407, 0.0541114],
                [0.9496631, 0.3085643, 0.0541114],
                [0.9767145, 0.2076071, 0.0541114],
                [0.9930648, 0.1043753, 0.0541114],
                [0.9985349, -0.0000000, 0.0541114],
                [0.9930648, -0.1043753, 0.0541114],
                [0.9767145, -0.2076071, 0.0541114],
                [0.9496631, -0.3085643, 0.0541114],
                [0.9122070, -0.4061407, 0.0541114],
                [0.8647566, -0.4992675, 0.0541114],
                [0.8078317, -0.5869241, 0.0541114],
                [0.7420561, -0.6681503, 0.0541114],
                [0.6681503, -0.7420561, 0.0541114],
                [0.5869241, -0.8078317, 0.0541114],
                [0.4992675, -0.8647566, 0.0541114],
                [0.4061407, -0.9122070, 0.0541114],
                [0.3085643, -0.9496631, 0.0541114],
                [0.2076071, -0.9767145, 0.0541114],
                [0.1043753, -0.9930648, 0.0541114],
                [-0.0000000, -0.9985349, 0.0541114],
                [-0.1043753, -0.9930648, 0.0541114],
                [-0.2076071, -0.9767145, 0.0541114],
                [-0.3085643, -0.9496631, 0.0541114],
                [-0.4061407, -0.9122070, 0.0541114],
                [-0.4992675, -0.8647566, 0.0541114],
                [-0.5869241, -0.8078317, 0.0541114],
                [-0.6681503, -0.7420561, 0.0541114],
                [-0.7420561, -0.6681503, 0.0541114],
                [-0.8078317, -0.5869241, 0.0541114],
                [-0.8647566, -0.4992675, 0.0541114],
                [-0.9122070, -0.4061407, 0.0541114],
                [-0.9496631, -0.3085643, 0.0541114],
                [-0.9767145, -0.2076071, 0.0541114],
                [-0.9930648, -0.1043753, 0.0541114],
                [-0.9985349, 0.0000000, 0.0541114],
                [-0.9930648, 0.1043753, 0.0541114],
                [-0.9767145, 0.2076071, 0.0541114],
                [-0.9496631, 0.3085643, 0.0541114],
                [-0.9122070, 0.4061407, 0.0541114],
                [-0.8647566, 0.4992675, 0.0541114],
                [-0.8078317, 0.5869241, 0.0541114],
                [-0.7420561, 0.6681503, 0.0541114],
                [-0.6681503, 0.7420561, 0.0541114],
                [-0.5869241, 0.8078317, 0.0541114],
                [-0.4992675, 0.8647566, 0.0541114],
                [-0.4061407, 0.9122070, 0.0541114],
                [-0.3085643, 0.9496631, 0.0541114],
                [-0.2076071, 0.9767145, 0.0541114],
                [-0.1043753, 0.9930648, 0.0541114],
                [0.0000000, 0.9868403, 0.1616979],
                [0.1031529, 0.9814343, 0.1616979],
                [0.2051756, 0.9652755, 0.1616979],
                [0.3049504, 0.9385409, 0.1616979],
                [0.4013841, 0.9015235, 0.1616979],
                [0.4934202, 0.8546288, 0.1616979],
                [0.5800502, 0.7983706, 0.1616979],
                [0.6603250, 0.7333653, 0.1616979],
                [0.7333653, 0.6603250, 0.1616979],
                [0.7983706, 0.5800502, 0.1616979],
                [0.8546288, 0.4934202, 0.1616979],
                [0.9015235, 0.4013841, 0.1616979],
                [0.9385409, 0.3049504, 0.1616979],
                [0.9652755, 0.2051756, 0.1616979],
                [0.9814343, 0.1031529, 0.1616979],
                [0.9868403, 0.0000000, 0.1616979],
                [0.9814343, -0.1031529, 0.1616979],
                [0.9652755, -0.2051756, 0.1616979],
                [0.9385409, -0.3049504, 0.1616979],
                [0.9015235, -0.4013841, 0.1616979],
                [0.8546288, -0.4934202, 0.1616979],
                [0.7983706, -0.5800502, 0.1616979],
                [0.7333653, -0.6603250, 0.1616979],
                [0.6603250, -0.7333653, 0.1616979],
                [0.5800502, -0.7983706, 0.1616979],
                [0.4934202, -0.8546288, 0.1616979],
                [0.4013841, -0.9015235, 0.1616979],
                [0.3049504, -0.9385409, 0.1616979],
                [0.2051756, -0.9652755, 0.1616979],
                [0.1031529, -0.9814343, 0.1616979],
                [0.0000000, -0.9868403, 0.1616979],
                [-0.1031529, -0.9814343, 0.1616979],
                [-0.2051756, -0.9652755, 0.1616979],
                [-0.3049504, -0.9385409, 0.1616979],
                [-0.4013841, -0.9015235, 0.1616979],
                [-0.4934202, -0.8546288, 0.1616979],
                [-0.5800502, -0.7983706, 0.1616979],
                [-0.6603250, -0.7333653, 0.1616979],
                [-0.7333653, -0.6603250, 0.1616979],
                [-0.7983706, -0.5800502, 0.1616979],
                [-0.8546288, -0.4934202, 0.1616979],
                [-0.9015235, -0.4013841, 0.1616979],
                [-0.9385409, -0.3049504, 0.1616979],
                [-0.9652755, -0.2051756, 0.1616979],
                [-0.9814343, -0.1031529, 0.1616979],
                [-0.9868403, 0.0000000, 0.1616979],
                [-0.9814343, 0.1031529, 0.1616979],
                [-0.9652755, 0.2051756, 0.1616979],
                [-0.9385409, 0.3049504, 0.1616979],
                [-0.9015235, 0.4013841, 0.1616979],
                [-0.8546288, 0.4934202, 0.1616979],
                [-0.7983706, 0.5800502, 0.1616979],
                [-0.7333653, 0.6603250, 0.1616979],
                [-0.6603250, 0.7333653, 0.1616979],
                [-0.5800502, 0.7983706, 0.1616979],
                [-0.4934202, 0.8546288, 0.1616979],
                [-0.4013841, 0.9015235, 0.1616979],
                [-0.3049504, 0.9385409, 0.1616979],
                [-0.2051756, 0.9652755, 0.1616979],
                [-0.1031529, 0.9814343, 0.1616979],
                [0.0000000, 0.9635902, 0.2673836],
                [0.1007226, 0.9583115, 0.2673836],
                [0.2003417, 0.9425334, 0.2673836],
                [0.2977657, 0.9164287, 0.2673836],
                [0.3919274, 0.8802834, 0.2673836],
                [0.4817951, 0.8344936, 0.2673836],
                [0.5663841, 0.7795608, 0.2673836],
                [0.6447677, 0.7160871, 0.2673836],
                [0.7160871, 0.6447677, 0.2673836],
                [0.7795608, 0.5663841, 0.2673836],
                [0.8344936, 0.4817951, 0.2673836],
                [0.8802834, 0.3919274, 0.2673836],
                [0.9164287, 0.2977657, 0.2673836],
                [0.9425334, 0.2003417, 0.2673836],
                [0.9583115, 0.1007226, 0.2673836],
                [0.9635902, 0.0000000, 0.2673836],
                [0.9583115, -0.1007226, 0.2673836],
                [0.9425334, -0.2003417, 0.2673836],
                [0.9164287, -0.2977657, 0.2673836],
                [0.8802834, -0.3919274, 0.2673836],
                [0.8344936, -0.4817951, 0.2673836],
                [0.7795608, -0.5663841, 0.2673836],
                [0.7160871, -0.6447677, 0.2673836],
                [0.6447677, -0.7160871, 0.2673836],
                [0.5663841, -0.7795608, 0.2673836],
                [0.4817951, -0.8344936, 0.2673836],
                [0.3919274, -0.8802834, 0.2673836],
                [0.2977657, -0.9164287, 0.2673836],
                [0.2003417, -0.9425334, 0.2673836],
                [0.1007226, -0.9583115, 0.2673836],
                [0.0000000, -0.9635902, 0.2673836],
                [-0.1007226, -0.9583115, 0.2673836],
                [-0.2003417, -0.9425334, 0.2673836],
                [-0.2977657, -0.9164287, 0.2673836],
                [-0.3919274, -0.8802834, 0.2673836],
                [-0.4817951, -0.8344936, 0.2673836],
                [-0.5663841, -0.7795608, 0.2673836],
                [-0.6447677, -0.7160871, 0.2673836],
                [-0.7160871, -0.6447677, 0.2673836],
                [-0.7795608, -0.5663841, 0.2673836],
                [-0.8344936, -0.4817951, 0.2673836],
                [-0.8802834, -0.3919274, 0.2673836],
                [-0.9164287, -0.2977657, 0.2673836],
                [-0.9425334, -0.2003417, 0.2673836],
                [-0.9583115, -0.1007226, 0.2673836],
                [-0.9635902, 0.0000000, 0.2673836],
                [-0.9583115, 0.1007226, 0.2673836],
                [-0.9425334, 0.2003417, 0.2673836],
                [-0.9164287, 0.2977657, 0.2673836],
                [-0.8802834, 0.3919274, 0.2673836],
                [-0.8344936, 0.4817951, 0.2673836],
                [-0.7795608, 0.5663841, 0.2673836],
                [-0.7160871, 0.6447677, 0.2673836],
                [-0.6447677, 0.7160871, 0.2673836],
                [-0.5663841, 0.7795608, 0.2673836],
                [-0.4817951, 0.8344936, 0.2673836],
                [-0.3919274, 0.8802834, 0.2673836],
                [-0.2977657, 0.9164287, 0.2673836],
                [-0.2003417, 0.9425334, 0.2673836],
                [-0.1007226, 0.9583115, 0.2673836],
                [0.0000000, 0.9290610, 0.3699264],
                [0.0971133, 0.9239716, 0.3699264],
                [0.1931627, 0.9087588, 0.3699264],
                [0.2870957, 0.8835896, 0.3699264],
                [0.3778832, 0.8487395, 0.3699264],
                [0.4645305, 0.8045905, 0.3699264],
                [0.5460884, 0.7516262, 0.3699264],
                [0.6216632, 0.6904269, 0.3699264],
                [0.6904269, 0.6216632, 0.3699264],
                [0.7516262, 0.5460884, 0.3699264],
                [0.8045905, 0.4645305, 0.3699264],
                [0.8487395, 0.3778832, 0.3699264],
                [0.8835896, 0.2870957, 0.3699264],
                [0.9087588, 0.1931627, 0.3699264],
                [0.9239716, 0.0971133, 0.3699264],
                [0.9290610, 0.0000000, 0.3699264],
                [0.9239716, -0.0971133, 0.3699264],
                [0.9087588, -0.1931627, 0.3699264],
                [0.8835896, -0.2870957, 0.3699264],
                [0.8487395, -0.3778832, 0.3699264],
                [0.8045905, -0.4645305, 0.3699264],
                [0.7516262, -0.5460884, 0.3699264],
                [0.6904269, -0.6216632, 0.3699264],
                [0.6216632, -0.6904269, 0.3699264],
                [0.5460884, -0.7516262, 0.3699264],
                [0.4645305, -0.8045905, 0.3699264],
                [0.3778832, -0.8487395, 0.3699264],
                [0.2870957, -0.8835896, 0.3699264],
                [0.1931627, -0.9087588, 0.3699264],
                [0.0971133, -0.9239716, 0.3699264],
                [0.0000000, -0.9290610, 0.3699264],
                [-0.0971133, -0.9239716, 0.3699264],
                [-0.1931627, -0.9087588, 0.3699264],
                [-0.2870957, -0.8835896, 0.3699264],
                [-0.3778832, -0.8487395, 0.3699264],
                [-0.4645305, -0.8045905, 0.3699264],
                [-0.5460884, -0.7516262, 0.3699264],
                [-0.6216632, -0.6904269, 0.3699264],
                [-0.6904269, -0.6216632, 0.3699264],
                [-0.7516262, -0.5460884, 0.3699264],
                [-0.8045905, -0.4645305, 0.3699264],
                [-0.8487395, -0.3778832, 0.3699264],
                [-0.8835896, -0.2870957, 0.3699264],
                [-0.9087588, -0.1931627, 0.3699264],
                [-0.9239716, -0.0971133, 0.3699264],
                [-0.9290610, 0.0000000, 0.3699264],
                [-0.9239716, 0.0971133, 0.3699264],
                [-0.9087588, 0.1931627, 0.3699264],
                [-0.8835896, 0.2870957, 0.3699264],
                [-0.8487395, 0.3778832, 0.3699264],
                [-0.8045905, 0.4645305, 0.3699264],
                [-0.7516262, 0.5460884, 0.3699264],
                [-0.6904269, 0.6216632, 0.3699264],
                [-0.6216632, 0.6904269, 0.3699264],
                [-0.5460884, 0.7516262, 0.3699264],
                [-0.4645305, 0.8045905, 0.3699264],
                [-0.3778832, 0.8487395, 0.3699264],
                [-0.2870957, 0.8835896, 0.3699264],
                [-0.1931627, 0.9087588, 0.3699264],
                [-0.0971133, 0.9239716, 0.3699264],
                [0.0000000, 0.8836123, 0.4682192],
                [0.1153345, 0.8760529, 0.4682192],
                [0.2286957, 0.8535040, 0.4682193],
                [0.3381438, 0.8163513, 0.4682192],
                [0.4418062, 0.7652307, 0.4682192],
                [0.5379091, 0.7010168, 0.4682192],
                [0.6248083, 0.6248083, 0.4682193],
                [0.7010168, 0.5379091, 0.4682192],
                [0.7652307, 0.4418062, 0.4682192],
                [0.8163513, 0.3381438, 0.4682192],
                [0.8535040, 0.2286957, 0.4682193],
                [0.8760529, 0.1153345, 0.4682192],
                [0.8836123, 0.0000000, 0.4682192],
                [0.8760529, -0.1153345, 0.4682192],
                [0.8535040, -0.2286957, 0.4682193],
                [0.8163513, -0.3381438, 0.4682192],
                [0.7652307, -0.4418062, 0.4682192],
                [0.7010168, -0.5379091, 0.4682192],
                [0.6248083, -0.6248083, 0.4682193],
                [0.5379091, -0.7010168, 0.4682192],
                [0.4418062, -0.7652307, 0.4682192],
                [0.3381438, -0.8163513, 0.4682192],
                [0.2286957, -0.8535040, 0.4682193],
                [0.1153345, -0.8760529, 0.4682192],
                [0.0000000, -0.8836123, 0.4682192],
                [-0.1153345, -0.8760529, 0.4682192],
                [-0.2286957, -0.8535040, 0.4682193],
                [-0.3381438, -0.8163513, 0.4682192],
                [-0.4418062, -0.7652307, 0.4682192],
                [-0.5379091, -0.7010168, 0.4682192],
                [-0.6248083, -0.6248083, 0.4682193],
                [-0.7010168, -0.5379091, 0.4682192],
                [-0.7652307, -0.4418062, 0.4682192],
                [-0.8163513, -0.3381438, 0.4682192],
                [-0.8535040, -0.2286957, 0.4682193],
                [-0.8760529, -0.1153345, 0.4682192],
                [-0.8836123, 0.0000000, 0.4682192],
                [-0.8760529, 0.1153345, 0.4682192],
                [-0.8535040, 0.2286957, 0.4682193],
                [-0.8163513, 0.3381438, 0.4682192],
                [-0.7652307, 0.4418062, 0.4682192],
                [-0.7010168, 0.5379091, 0.4682192],
                [-0.6248083, 0.6248083, 0.4682193],
                [-0.5379091, 0.7010168, 0.4682192],
                [-0.4418062, 0.7652307, 0.4682192],
                [-0.3381438, 0.8163513, 0.4682192],
                [-0.2286957, 0.8535040, 0.4682193],
                [-0.1153345, 0.8760529, 0.4682192],
                [0.0000000, 0.8278694, 0.5609210],
                [0.1080586, 0.8207868, 0.5609210],
                [0.2142684, 0.7996604, 0.5609210],
                [0.3168119, 0.7648516, 0.5609210],
                [0.4139347, 0.7169559, 0.5609210],
                [0.5039749, 0.6567929, 0.5609210],
                [0.5853920, 0.5853920, 0.5609210],
                [0.6567929, 0.5039749, 0.5609210],
                [0.7169559, 0.4139347, 0.5609210],
                [0.7648516, 0.3168119, 0.5609210],
                [0.7996604, 0.2142684, 0.5609210],
                [0.8207868, 0.1080586, 0.5609210],
                [0.8278694, 0.0000000, 0.5609210],
                [0.8207868, -0.1080586, 0.5609210],
                [0.7996604, -0.2142684, 0.5609210],
                [0.7648516, -0.3168119, 0.5609210],
                [0.7169559, -0.4139347, 0.5609210],
                [0.6567929, -0.5039749, 0.5609210],
                [0.5853920, -0.5853920, 0.5609210],
                [0.5039749, -0.6567929, 0.5609210],
                [0.4139347, -0.7169559, 0.5609210],
                [0.3168119, -0.7648516, 0.5609210],
                [0.2142684, -0.7996604, 0.5609210],
                [0.1080586, -0.8207868, 0.5609210],
                [0.0000000, -0.8278694, 0.5609210],
                [-0.1080586, -0.8207868, 0.5609210],
                [-0.2142684, -0.7996604, 0.5609210],
                [-0.3168119, -0.7648516, 0.5609210],
                [-0.4139347, -0.7169559, 0.5609210],
                [-0.5039749, -0.6567929, 0.5609210],
                [-0.5853920, -0.5853920, 0.5609210],
                [-0.6567929, -0.5039749, 0.5609210],
                [-0.7169559, -0.4139347, 0.5609210],
                [-0.7648516, -0.3168119, 0.5609210],
                [-0.7996604, -0.2142684, 0.5609210],
                [-0.8207868, -0.1080586, 0.5609210],
                [-0.8278694, 0.0000000, 0.5609210],
                [-0.8207868, 0.1080586, 0.5609210],
                [-0.7996604, 0.2142684, 0.5609210],
                [-0.7648516, 0.3168119, 0.5609210],
                [-0.7169559, 0.4139347, 0.5609210],
                [-0.6567929, 0.5039749, 0.5609210],
                [-0.5853920, 0.5853920, 0.5609210],
                [-0.5039749, 0.6567929, 0.5609210],
                [-0.4139347, 0.7169559, 0.5609210],
                [-0.3168119, 0.7648516, 0.5609210],
                [-0.2142684, 0.7996604, 0.5609210],
                [-0.1080586, 0.8207868, 0.5609210],
                [0.0000000, 0.7624648, 0.6470297],
                [0.0995216, 0.7559418, 0.6470297],
                [0.1973404, 0.7364845, 0.6470297],
                [0.2917826, 0.7044256, 0.6470297],
                [0.3812324, 0.6603139, 0.6470297],
                [0.4641592, 0.6049040, 0.6470297],
                [0.5391440, 0.5391440, 0.6470297],
                [0.6049040, 0.4641592, 0.6470297],
                [0.6603139, 0.3812324, 0.6470297],
                [0.7044256, 0.2917826, 0.6470297],
                [0.7364845, 0.1973404, 0.6470297],
                [0.7559418, 0.0995216, 0.6470297],
                [0.7624648, 0.0000000, 0.6470297],
                [0.7559418, -0.0995216, 0.6470297],
                [0.7364845, -0.1973404, 0.6470297],
                [0.7044256, -0.2917826, 0.6470297],
                [0.6603139, -0.3812324, 0.6470297],
                [0.6049040, -0.4641592, 0.6470297],
                [0.5391440, -0.5391440, 0.6470297],
                [0.4641592, -0.6049040, 0.6470297],
                [0.3812324, -0.6603139, 0.6470297],
                [0.2917826, -0.7044256, 0.6470297],
                [0.1973404, -0.7364845, 0.6470297],
                [0.0995216, -0.7559418, 0.6470297],
                [0.0000000, -0.7624648, 0.6470297],
                [-0.0995216, -0.7559418, 0.6470297],
                [-0.1973404, -0.7364845, 0.6470297],
                [-0.2917826, -0.7044256, 0.6470297],
                [-0.3812324, -0.6603139, 0.6470297],
                [-0.4641592, -0.6049040, 0.6470297],
                [-0.5391440, -0.5391440, 0.6470297],
                [-0.6049040, -0.4641592, 0.6470297],
                [-0.6603139, -0.3812324, 0.6470297],
                [-0.7044256, -0.2917826, 0.6470297],
                [-0.7364845, -0.1973404, 0.6470297],
                [-0.7559418, -0.0995216, 0.6470297],
                [-0.7624648, 0.0000000, 0.6470297],
                [-0.7559418, 0.0995216, 0.6470297],
                [-0.7364845, 0.1973404, 0.6470297],
                [-0.7044256, 0.2917826, 0.6470297],
                [-0.6603139, 0.3812324, 0.6470297],
                [-0.6049040, 0.4641592, 0.6470297],
                [-0.5391440, 0.5391440, 0.6470297],
                [-0.4641592, 0.6049040, 0.6470297],
                [-0.3812324, 0.6603139, 0.6470297],
                [-0.2917826, 0.7044256, 0.6470297],
                [-0.1973404, 0.7364845, 0.6470297],
                [-0.0995216, 0.7559418, 0.6470297],
                [0.0000000, 0.6881822, 0.7255379],
                [0.0898258, 0.6822947, 0.7255379],
                [0.1781147, 0.6647330, 0.7255379],
                [0.2633559, 0.6357975, 0.7255379],
                [0.3440911, 0.5959833, 0.7255379],
                [0.4189388, 0.5459717, 0.7255379],
                [0.4866183, 0.4866183, 0.7255379],
                [0.5459717, 0.4189388, 0.7255379],
                [0.5959833, 0.3440911, 0.7255379],
                [0.6357975, 0.2633559, 0.7255379],
                [0.6647330, 0.1781147, 0.7255379],
                [0.6822947, 0.0898258, 0.7255379],
                [0.6881822, 0.0000000, 0.7255379],
                [0.6822947, -0.0898258, 0.7255379],
                [0.6647330, -0.1781147, 0.7255379],
                [0.6357975, -0.2633559, 0.7255379],
                [0.5959833, -0.3440911, 0.7255379],
                [0.5459717, -0.4189388, 0.7255379],
                [0.4866183, -0.4866183, 0.7255379],
                [0.4189388, -0.5459717, 0.7255379],
                [0.3440911, -0.5959833, 0.7255379],
                [0.2633559, -0.6357975, 0.7255379],
                [0.1781147, -0.6647330, 0.7255379],
                [0.0898258, -0.6822947, 0.7255379],
                [0.0000000, -0.6881822, 0.7255379],
                [-0.0898258, -0.6822947, 0.7255379],
                [-0.1781147, -0.6647330, 0.7255379],
                [-0.2633559, -0.6357975, 0.7255379],
                [-0.3440911, -0.5959833, 0.7255379],
                [-0.4189388, -0.5459717, 0.7255379],
                [-0.4866183, -0.4866183, 0.7255379],
                [-0.5459717, -0.4189388, 0.7255379],
                [-0.5959833, -0.3440911, 0.7255379],
                [-0.6357975, -0.2633559, 0.7255379],
                [-0.6647330, -0.1781147, 0.7255379],
                [-0.6822947, -0.0898258, 0.7255379],
                [-0.6881822, 0.0000000, 0.7255379],
                [-0.6822947, 0.0898258, 0.7255379],
                [-0.6647330, 0.1781147, 0.7255379],
                [-0.6357975, 0.2633559, 0.7255379],
                [-0.5959833, 0.3440911, 0.7255379],
                [-0.5459717, 0.4189388, 0.7255379],
                [-0.4866183, 0.4866183, 0.7255379],
                [-0.4189388, 0.5459717, 0.7255379],
                [-0.3440911, 0.5959833, 0.7255379],
                [-0.2633559, 0.6357975, 0.7255379],
                [-0.1781147, 0.6647330, 0.7255379],
                [-0.0898258, 0.6822947, 0.7255379],
                [0.0000000, 0.6056963, 0.7956959],
                [0.1051781, 0.5964944, 0.7956959],
                [0.2071603, 0.5691683, 0.7956959],
                [0.3028481, 0.5245484, 0.7956959],
                [0.3893341, 0.4639903, 0.7956959],
                [0.4639903, 0.3893341, 0.7956959],
                [0.5245484, 0.3028481, 0.7956959],
                [0.5691683, 0.2071603, 0.7956959],
                [0.5964944, 0.1051781, 0.7956959],
                [0.6056963, 0.0000000, 0.7956959],
                [0.5964944, -0.1051781, 0.7956959],
                [0.5691683, -0.2071603, 0.7956959],
                [0.5245484, -0.3028481, 0.7956959],
                [0.4639903, -0.3893341, 0.7956959],
                [0.3893341, -0.4639903, 0.7956959],
                [0.3028481, -0.5245484, 0.7956959],
                [0.2071603, -0.5691683, 0.7956959],
                [0.1051781, -0.5964944, 0.7956959],
                [0.0000000, -0.6056963, 0.7956959],
                [-0.1051781, -0.5964944, 0.7956959],
                [-0.2071603, -0.5691683, 0.7956959],
                [-0.3028481, -0.5245484, 0.7956959],
                [-0.3893341, -0.4639903, 0.7956959],
                [-0.4639903, -0.3893341, 0.7956959],
                [-0.5245484, -0.3028481, 0.7956959],
                [-0.5691683, -0.2071603, 0.7956959],
                [-0.5964944, -0.1051781, 0.7956959],
                [-0.6056963, 0.0000000, 0.7956959],
                [-0.5964944, 0.1051781, 0.7956959],
                [-0.5691683, 0.2071603, 0.7956959],
                [-0.5245484, 0.3028481, 0.7956959],
                [-0.4639903, 0.3893341, 0.7956959],
                [-0.3893341, 0.4639903, 0.7956959],
                [-0.3028481, 0.5245484, 0.7956959],
                [-0.2071603, 0.5691683, 0.7956959],
                [-0.1051781, 0.5964944, 0.7956959],
                [0.0000000, 0.5164506, 0.8563170],
                [0.0896807, 0.5086046, 0.8563170],
                [0.1766365, 0.4853048, 0.8563170],
                [0.2582253, 0.4472594, 0.8563170],
                [0.3319681, 0.3956241, 0.8563170],
                [0.3956241, 0.3319681, 0.8563170],
                [0.4472594, 0.2582253, 0.8563170],
                [0.4853048, 0.1766365, 0.8563170],
                [0.5086046, 0.0896807, 0.8563170],
                [0.5164506, 0.0000000, 0.8563170],
                [0.5086046, -0.0896807, 0.8563170],
                [0.4853048, -0.1766365, 0.8563170],
                [0.4472594, -0.2582253, 0.8563170],
                [0.3956241, -0.3319681, 0.8563170],
                [0.3319681, -0.3956241, 0.8563170],
                [0.2582253, -0.4472594, 0.8563170],
                [0.1766365, -0.4853048, 0.8563170],
                [0.0896807, -0.5086046, 0.8563170],
                [0.0000000, -0.5164506, 0.8563170],
                [-0.0896807, -0.5086046, 0.8563170],
                [-0.1766365, -0.4853048, 0.8563170],
                [-0.2582253, -0.4472594, 0.8563170],
                [-0.3319681, -0.3956241, 0.8563170],
                [-0.3956241, -0.3319681, 0.8563170],
                [-0.4472594, -0.2582253, 0.8563170],
                [-0.4853048, -0.1766365, 0.8563170],
                [-0.5086046, -0.0896807, 0.8563170],
                [-0.5164506, 0.0000000, 0.8563170],
                [-0.5086046, 0.0896807, 0.8563170],
                [-0.4853048, 0.1766365, 0.8563170],
                [-0.4472594, 0.2582253, 0.8563170],
                [-0.3956241, 0.3319681, 0.8563170],
                [-0.3319681, 0.3956241, 0.8563170],
                [-0.2582253, 0.4472594, 0.8563170],
                [-0.1766365, 0.4853048, 0.8563170],
                [-0.0896807, 0.5086046, 0.8563170],
                [0.0000000, 0.4208095, 0.9071490],
                [0.1089135, 0.4064708, 0.9071490],
                [0.2104047, 0.3644317, 0.9071490],
                [0.2975572, 0.2975572, 0.9071490],
                [0.3644317, 0.2104047, 0.9071490],
                [0.4064708, 0.1089135, 0.9071490],
                [0.4208095, 0.0000000, 0.9071490],
                [0.4064708, -0.1089135, 0.9071490],
                [0.3644317, -0.2104047, 0.9071490],
                [0.2975572, -0.2975572, 0.9071490],
                [0.2104047, -0.3644317, 0.9071490],
                [0.1089135, -0.4064708, 0.9071490],
                [0.0000000, -0.4208095, 0.9071490],
                [-0.1089135, -0.4064708, 0.9071490],
                [-0.2104047, -0.3644317, 0.9071490],
                [-0.2975572, -0.2975572, 0.9071490],
                [-0.3644317, -0.2104047, 0.9071490],
                [-0.4064708, -0.1089135, 0.9071490],
                [-0.4208095, 0.0000000, 0.9071490],
                [-0.4064708, 0.1089135, 0.9071490],
                [-0.3644317, 0.2104047, 0.9071490],
                [-0.2975572, 0.2975572, 0.9071490],
                [-0.2104047, 0.3644317, 0.9071490],
                [-0.1089135, 0.4064708, 0.9071490],
                [0.0000000, 0.3212214, 0.9470041],
                [0.0831382, 0.3102761, 0.9470041],
                [0.1606107, 0.2781859, 0.9470041],
                [0.2271378, 0.2271378, 0.9470041],
                [0.2781859, 0.1606107, 0.9470041],
                [0.3102761, 0.0831382, 0.9470041],
                [0.3212214, 0.0000000, 0.9470041],
                [0.3102761, -0.0831382, 0.9470041],
                [0.2781859, -0.1606107, 0.9470041],
                [0.2271378, -0.2271378, 0.9470041],
                [0.1606107, -0.2781859, 0.9470041],
                [0.0831382, -0.3102761, 0.9470041],
                [0.0000000, -0.3212214, 0.9470041],
                [-0.0831382, -0.3102761, 0.9470041],
                [-0.1606107, -0.2781859, 0.9470041],
                [-0.2271378, -0.2271378, 0.9470041],
                [-0.2781859, -0.1606107, 0.9470041],
                [-0.3102761, -0.0831382, 0.9470041],
                [-0.3212214, 0.0000000, 0.9470041],
                [-0.3102761, 0.0831382, 0.9470041],
                [-0.2781859, 0.1606107, 0.9470041],
                [-0.2271378, 0.2271378, 0.9470041],
                [-0.1606107, 0.2781859, 0.9470041],
                [-0.0831382, 0.3102761, 0.9470041],
                [0.0000000, 0.2169121, 0.9761911],
                [0.1084561, 0.1878514, 0.9761911],
                [0.1878514, 0.1084561, 0.9761911],
                [0.2169121, 0.0000000, 0.9761911],
                [0.1878514, -0.1084561, 0.9761911],
                [0.1084561, -0.1878514, 0.9761911],
                [0.0000000, -0.2169121, 0.9761911],
                [-0.1084561, -0.1878514, 0.9761911],
                [-0.1878514, -0.1084561, 0.9761911],
                [-0.2169121, 0.0000000, 0.9761911],
                [-0.1878514, 0.1084561, 0.9761911],
                [-0.1084561, 0.1878514, 0.9761911],
                [0.0000000, 0.1157325, 0.9932804],
                [0.0578662, 0.1002273, 0.9932804],
                [0.1002273, 0.0578662, 0.9932804],
                [0.1157325, 0.0000000, 0.9932804],
                [0.1002273, -0.0578662, 0.9932804],
                [0.0578662, -0.1002273, 0.9932804],
                [0.0000000, -0.1157325, 0.9932804],
                [-0.0578662, -0.1002273, 0.9932804],
                [-0.1002273, -0.0578662, 0.9932804],
                [-0.1157325, 0.0000000, 0.9932804],
                [-0.1002273, 0.0578662, 0.9932804],
                [-0.0578662, 0.1002273, 0.9932804],
                [0.0000000, -0.0000000, 1.0000000]
            ]),
            "patch_count": 577,
            "patch_conversion_factor": np.array([
                0.0113221971,
                0.0111894547,
                0.0109255262,
                0.0105335058,
                0.0125224872,
                0.0117312774,
                0.0108025291,
                0.00974713106,
                0.011436609,
                0.00974295956,
                0.0119026242,
                0.00905126163,
                0.0121875626,
                0.00612971396,
                0.00921483254,
            ]),
            "patches_per_row": np.array([
                60,
                60,
                60,
                60,
                48,
                48,
                48,
                48,
                36,
                36,
                24,
                24,
                12,
                12,
                1,
            ]),
            "conversion_factor": np.array([
                0.0113222 , 0.0113222 , 0.0113222 , 0.0113222 , 0.0113222 ,
                0.0113222 , 0.0113222 , 0.0113222 , 0.0113222 , 0.0113222 ,
                0.0113222 , 0.0113222 , 0.0113222 , 0.0113222 , 0.0113222 ,
                0.0113222 , 0.0113222 , 0.0113222 , 0.0113222 , 0.0113222 ,
                0.0113222 , 0.0113222 , 0.0113222 , 0.0113222 , 0.0113222 ,
                0.0113222 , 0.0113222 , 0.0113222 , 0.0113222 , 0.0113222 ,
                0.0113222 , 0.0113222 , 0.0113222 , 0.0113222 , 0.0113222 ,
                0.0113222 , 0.0113222 , 0.0113222 , 0.0113222 , 0.0113222 ,
                0.0113222 , 0.0113222 , 0.0113222 , 0.0113222 , 0.0113222 ,
                0.0113222 , 0.0113222 , 0.0113222 , 0.0113222 , 0.0113222 ,
                0.0113222 , 0.0113222 , 0.0113222 , 0.0113222 , 0.0113222 ,
                0.0113222 , 0.0113222 , 0.0113222 , 0.0113222 , 0.0113222 ,
                0.01118945, 0.01118945, 0.01118945, 0.01118945, 0.01118945,
                0.01118945, 0.01118945, 0.01118945, 0.01118945, 0.01118945,
                0.01118945, 0.01118945, 0.01118945, 0.01118945, 0.01118945,
                0.01118945, 0.01118945, 0.01118945, 0.01118945, 0.01118945,
                0.01118945, 0.01118945, 0.01118945, 0.01118945, 0.01118945,
                0.01118945, 0.01118945, 0.01118945, 0.01118945, 0.01118945,
                0.01118945, 0.01118945, 0.01118945, 0.01118945, 0.01118945,
                0.01118945, 0.01118945, 0.01118945, 0.01118945, 0.01118945,
                0.01118945, 0.01118945, 0.01118945, 0.01118945, 0.01118945,
                0.01118945, 0.01118945, 0.01118945, 0.01118945, 0.01118945,
                0.01118945, 0.01118945, 0.01118945, 0.01118945, 0.01118945,
                0.01118945, 0.01118945, 0.01118945, 0.01118945, 0.01118945,
                0.01092553, 0.01092553, 0.01092553, 0.01092553, 0.01092553,
                0.01092553, 0.01092553, 0.01092553, 0.01092553, 0.01092553,
                0.01092553, 0.01092553, 0.01092553, 0.01092553, 0.01092553,
                0.01092553, 0.01092553, 0.01092553, 0.01092553, 0.01092553,
                0.01092553, 0.01092553, 0.01092553, 0.01092553, 0.01092553,
                0.01092553, 0.01092553, 0.01092553, 0.01092553, 0.01092553,
                0.01092553, 0.01092553, 0.01092553, 0.01092553, 0.01092553,
                0.01092553, 0.01092553, 0.01092553, 0.01092553, 0.01092553,
                0.01092553, 0.01092553, 0.01092553, 0.01092553, 0.01092553,
                0.01092553, 0.01092553, 0.01092553, 0.01092553, 0.01092553,
                0.01092553, 0.01092553, 0.01092553, 0.01092553, 0.01092553,
                0.01092553, 0.01092553, 0.01092553, 0.01092553, 0.01092553,
                0.01053351, 0.01053351, 0.01053351, 0.01053351, 0.01053351,
                0.01053351, 0.01053351, 0.01053351, 0.01053351, 0.01053351,
                0.01053351, 0.01053351, 0.01053351, 0.01053351, 0.01053351,
                0.01053351, 0.01053351, 0.01053351, 0.01053351, 0.01053351,
                0.01053351, 0.01053351, 0.01053351, 0.01053351, 0.01053351,
                0.01053351, 0.01053351, 0.01053351, 0.01053351, 0.01053351,
                0.01053351, 0.01053351, 0.01053351, 0.01053351, 0.01053351,
                0.01053351, 0.01053351, 0.01053351, 0.01053351, 0.01053351,
                0.01053351, 0.01053351, 0.01053351, 0.01053351, 0.01053351,
                0.01053351, 0.01053351, 0.01053351, 0.01053351, 0.01053351,
                0.01053351, 0.01053351, 0.01053351, 0.01053351, 0.01053351,
                0.01053351, 0.01053351, 0.01053351, 0.01053351, 0.01053351,
                0.01252249, 0.01252249, 0.01252249, 0.01252249, 0.01252249,
                0.01252249, 0.01252249, 0.01252249, 0.01252249, 0.01252249,
                0.01252249, 0.01252249, 0.01252249, 0.01252249, 0.01252249,
                0.01252249, 0.01252249, 0.01252249, 0.01252249, 0.01252249,
                0.01252249, 0.01252249, 0.01252249, 0.01252249, 0.01252249,
                0.01252249, 0.01252249, 0.01252249, 0.01252249, 0.01252249,
                0.01252249, 0.01252249, 0.01252249, 0.01252249, 0.01252249,
                0.01252249, 0.01252249, 0.01252249, 0.01252249, 0.01252249,
                0.01252249, 0.01252249, 0.01252249, 0.01252249, 0.01252249,
                0.01252249, 0.01252249, 0.01252249, 0.01173128, 0.01173128,
                0.01173128, 0.01173128, 0.01173128, 0.01173128, 0.01173128,
                0.01173128, 0.01173128, 0.01173128, 0.01173128, 0.01173128,
                0.01173128, 0.01173128, 0.01173128, 0.01173128, 0.01173128,
                0.01173128, 0.01173128, 0.01173128, 0.01173128, 0.01173128,
                0.01173128, 0.01173128, 0.01173128, 0.01173128, 0.01173128,
                0.01173128, 0.01173128, 0.01173128, 0.01173128, 0.01173128,
                0.01173128, 0.01173128, 0.01173128, 0.01173128, 0.01173128,
                0.01173128, 0.01173128, 0.01173128, 0.01173128, 0.01173128,
                0.01173128, 0.01173128, 0.01173128, 0.01173128, 0.01173128,
                0.01173128, 0.01080253, 0.01080253, 0.01080253, 0.01080253,
                0.01080253, 0.01080253, 0.01080253, 0.01080253, 0.01080253,
                0.01080253, 0.01080253, 0.01080253, 0.01080253, 0.01080253,
                0.01080253, 0.01080253, 0.01080253, 0.01080253, 0.01080253,
                0.01080253, 0.01080253, 0.01080253, 0.01080253, 0.01080253,
                0.01080253, 0.01080253, 0.01080253, 0.01080253, 0.01080253,
                0.01080253, 0.01080253, 0.01080253, 0.01080253, 0.01080253,
                0.01080253, 0.01080253, 0.01080253, 0.01080253, 0.01080253,
                0.01080253, 0.01080253, 0.01080253, 0.01080253, 0.01080253,
                0.01080253, 0.01080253, 0.01080253, 0.01080253, 0.00974713,
                0.00974713, 0.00974713, 0.00974713, 0.00974713, 0.00974713,
                0.00974713, 0.00974713, 0.00974713, 0.00974713, 0.00974713,
                0.00974713, 0.00974713, 0.00974713, 0.00974713, 0.00974713,
                0.00974713, 0.00974713, 0.00974713, 0.00974713, 0.00974713,
                0.00974713, 0.00974713, 0.00974713, 0.00974713, 0.00974713,
                0.00974713, 0.00974713, 0.00974713, 0.00974713, 0.00974713,
                0.00974713, 0.00974713, 0.00974713, 0.00974713, 0.00974713,
                0.00974713, 0.00974713, 0.00974713, 0.00974713, 0.00974713,
                0.00974713, 0.00974713, 0.00974713, 0.00974713, 0.00974713,
                0.00974713, 0.00974713, 0.01143661, 0.01143661, 0.01143661,
                0.01143661, 0.01143661, 0.01143661, 0.01143661, 0.01143661,
                0.01143661, 0.01143661, 0.01143661, 0.01143661, 0.01143661,
                0.01143661, 0.01143661, 0.01143661, 0.01143661, 0.01143661,
                0.01143661, 0.01143661, 0.01143661, 0.01143661, 0.01143661,
                0.01143661, 0.01143661, 0.01143661, 0.01143661, 0.01143661,
                0.01143661, 0.01143661, 0.01143661, 0.01143661, 0.01143661,
                0.01143661, 0.01143661, 0.01143661, 0.00974296, 0.00974296,
                0.00974296, 0.00974296, 0.00974296, 0.00974296, 0.00974296,
                0.00974296, 0.00974296, 0.00974296, 0.00974296, 0.00974296,
                0.00974296, 0.00974296, 0.00974296, 0.00974296, 0.00974296,
                0.00974296, 0.00974296, 0.00974296, 0.00974296, 0.00974296,
                0.00974296, 0.00974296, 0.00974296, 0.00974296, 0.00974296,
                0.00974296, 0.00974296, 0.00974296, 0.00974296, 0.00974296,
                0.00974296, 0.00974296, 0.00974296, 0.00974296, 0.01190262,
                0.01190262, 0.01190262, 0.01190262, 0.01190262, 0.01190262,
                0.01190262, 0.01190262, 0.01190262, 0.01190262, 0.01190262,
                0.01190262, 0.01190262, 0.01190262, 0.01190262, 0.01190262,
                0.01190262, 0.01190262, 0.01190262, 0.01190262, 0.01190262,
                0.01190262, 0.01190262, 0.01190262, 0.00905126, 0.00905126,
                0.00905126, 0.00905126, 0.00905126, 0.00905126, 0.00905126,
                0.00905126, 0.00905126, 0.00905126, 0.00905126, 0.00905126,
                0.00905126, 0.00905126, 0.00905126, 0.00905126, 0.00905126,
                0.00905126, 0.00905126, 0.00905126, 0.00905126, 0.00905126,
                0.00905126, 0.00905126, 0.01218756, 0.01218756, 0.01218756,
                0.01218756, 0.01218756, 0.01218756, 0.01218756, 0.01218756,
                0.01218756, 0.01218756, 0.01218756, 0.01218756, 0.00612971,
                0.00612971, 0.00612971, 0.00612971, 0.00612971, 0.00612971,
                0.00612971, 0.00612971, 0.00612971, 0.00612971, 0.00612971,
                0.00612971, 0.00921483
            ]),
        }

        self.direct_sky_radiation_rose_values = None
        self.diffuse_sky_radiation_rose_values = None
        self.total_sky_radiation_rose_values = None

    def read(self):
        with open(self.filepath, "r") as f:
            dat = f.readlines()

            # Read location data
            self.city, self.region, self.country, self.dataset_type, self.station_id, self.latitude, self.longitude, self.time_zone, self.elevation = dat[0].strip().split(",")[1:]
            self.latitude = float(self.latitude)
            self.longitude = float(self.longitude)
            self.time_zone = float(self.time_zone)
            self.elevation = float(self.elevation)

            # Read design conditions data
            self.design_conditions = ",".join(dat[1].strip().split(",")[1:])

            # Read typical extreme periods data
            self.typical_extreme_periods = ",".join(dat[2].strip().split(",")[1:])

            # Read ground temperatures data from weatherfile
            self.ground_temperatures = ",".join(dat[3].strip().split(",")[1:])

            # Read holidays/daylight savings data
            self.holidays_daylight_savings = ",".join(dat[4].strip().split(",")[1:])

            # Read comments 1 data
            self.comments_1 = ",".join(dat[5].strip().split(",")[1:])

            # Read comments 2 data
            self.comments_2 = ",".join(dat[6].strip().split(",")[1:])

            # Read the data table
            df = pd.read_csv(StringIO("\n".join(dat[8:])), header=None)

            # Rename columns
            df.columns = [
                'year',
                'month',
                'day',
                'hour',
                'minute',
                'data_source_and_uncertainty_flags',
                'dry_bulb_temperature',
                'dew_point_temperature',
                'relative_humidity',
                'atmospheric_station_pressure',
                'extraterrestrial_horizontal_radiation',
                'extraterrestrial_direct_normal_radiation',
                'horizontal_infrared_radiation_intensity',
                'global_horizontal_radiation',
                'direct_normal_radiation',
                'diffuse_horizontal_radiation',
                'global_horizontal_illuminance',
                'direct_normal_illuminance',
                'diffuse_horizontal_illuminance',
                'zenith_luminance',
                'wind_direction',
                'wind_speed',
                'total_sky_cover',
                'opaque_sky_cover',
                'visibility',
                'ceiling_height',
                'present_weather_observation',
                'present_weather_codes',
                'precipitable_water',
                'aerosol_optical_depth',
                'snow_depth',
                'days_since_last_snowfall',
                'albedo',
                'liquid_precipitation_depth',
                'liquid_precipitation_quantity',
            ]

            # Create datetime index - using 2018 as base year (a Monday starting year without leap-day)
            df.index = pd.date_range(
                start="2018-01-01 00:00:00",
                end="2019-01-01 00:00:00",
                freq="60T",
                closed="left").tz_localize("UTC").tz_convert(int(self.time_zone * 60 * 60))

            # Drop date/time columns
            df.drop(columns=["year", "month", "day", "hour", "minute"], inplace=True)

            # Make loaded data accessible
            self.df = df
            self.data_source_and_uncertainty_flags = df.data_source_and_uncertainty_flags
            self.dry_bulb_temperature = df.dry_bulb_temperature
            self.dew_point_temperature = df.dew_point_temperature
            self.relative_humidity = df.relative_humidity
            self.atmospheric_station_pressure = df.atmospheric_station_pressure
            self.extraterrestrial_horizontal_radiation = df.extraterrestrial_horizontal_radiation
            self.extraterrestrial_direct_normal_radiation = df.extraterrestrial_direct_normal_radiation
            self.horizontal_infrared_radiation_intensity = df.horizontal_infrared_radiation_intensity
            self.global_horizontal_radiation = df.global_horizontal_radiation
            self.direct_normal_radiation = df.direct_normal_radiation
            self.diffuse_horizontal_radiation = df.diffuse_horizontal_radiation
            self.global_horizontal_illuminance = df.global_horizontal_illuminance
            self.direct_normal_illuminance = df.direct_normal_illuminance
            self.diffuse_horizontal_illuminance = df.diffuse_horizontal_illuminance
            self.zenith_luminance = df.zenith_luminance
            self.wind_direction = df.wind_direction
            self.wind_speed = df.wind_speed
            self.total_sky_cover = df.total_sky_cover
            self.opaque_sky_cover = df.opaque_sky_cover
            self.visibility = df.visibility
            self.ceiling_height = df.ceiling_height
            self.present_weather_observation = df.present_weather_observation
            self.present_weather_codes = df.present_weather_codes
            self.precipitable_water = df.precipitable_water
            self.aerosol_optical_depth = df.aerosol_optical_depth
            self.snow_depth = df.snow_depth
            self.days_since_last_snowfall = df.days_since_last_snowfall
            self.albedo = df.albedo
            self.liquid_precipitation_depth = df.liquid_precipitation_depth
            self.liquid_precipitation_quantity = df.liquid_precipitation_quantity

    def to_csv(self, file_path=None):
        if file_path is None:
            file_path = pathlib.Path(self.filepath).with_suffix(".csv")
        self.df.to_csv(file_path)
        self.csv_file = str(file_path)
        print("CSV file created: {0:}".format(self.csv_file))
        return self.csv_file

    def to_wea(self, file_path=None):
        if file_path is None:
            file_path = pathlib.Path(self.filepath).with_suffix(".wea")
        header = "place {0:}_{1:}\nlatitude {2:0.4f}\nlongitude {3:0.4f}\ntime_zone {4:0.2f}\nsite_elevation {5:0.2f}\nweather_data_file_units 1".format(slugify(self.city), slugify(self.country), self.latitude, self.longitude, -self.time_zone / 15, self.elevation)
        values = []
        for n, dt in enumerate(self.df.index):
            values.append("{0:} {1:} {2:}.5 {3:} {4:}".format(dt.month, dt.day, dt.hour, self.direct_normal_radiation.values[n], self.diffuse_horizontal_radiation[n]))
        with open(file_path, "w") as f:
            f.write(header + "\n" + "\n".join(values) + "\n")
        self.wea_file = str(file_path)
        print("WEA file created: {0:}".format(self.wea_file))
        return self.wea_file

    def run_psychrometrics(self):
        self.wet_bulb_temperature = self.df.apply(
            lambda x: wet_bulb_temperature_relative_humidity(dry_bulb_temperature=x["dry_bulb_temperature"],
                                                       relative_humidity=x["relative_humidity"] / 100,
                                                       pressure=x["atmospheric_station_pressure"] / 1000), axis=1)
        print("Wet-bulb temperature calculated")

        self.enthalpy = self.df.apply(
            lambda x: enthalpy_relative_humidity(dry_bulb_temperature=x["dry_bulb_temperature"],
                                                 relative_humidity=x["relative_humidity"] / 100,
                                                 pressure=x["atmospheric_station_pressure"] / 1000), axis=1)
        print("Enthalpy calculated")

        self.humidity_ratio = self.df.apply(
            lambda x: humidity_ratio_relative_humidity(dry_bulb_temperature=x["dry_bulb_temperature"],
                                                             relative_humidity=x["relative_humidity"] / 100,
                                                             pressure=x["atmospheric_station_pressure"] / 1000), axis=1)
        print("Humidity ratio calculated")

        self.wet_bulb_temperature.name = "wet_bulb_temperature"
        self.enthalpy.name = "enthalpy"
        self.humidity_ratio.name = "humidity_ratio"
        self.df = pd.concat([self.df, self.wet_bulb_temperature, self.enthalpy, self.humidity_ratio], axis=1)

    def run_sunposition(self):
        from pysolar.solar import get_altitude_fast, get_azimuth_fast
        self.solar_altitude = pd.Series(index=self.df.index, data=[float(get_altitude_fast(self.latitude, self.longitude, i)) for i in self.df.index], name="solar_altitude")
        print("Solar altitude calculated")
        self.solar_azimuth = pd.Series(index=self.df.index, data=[float(get_azimuth_fast(self.latitude, self.longitude, i)) for i in self.df.index], name="solar_azimuth")
        print("Solar azimuth calculated")
        self.df = pd.concat([self.df, self.solar_altitude, self.solar_azimuth], axis=1)

    def run_ground_temperatures(self, depth=0.1):
        mn = self.dry_bulb_temperature.mean()
        rng = self.dry_bulb_temperature.max() - self.dry_bulb_temperature.min()
        coldest_day = self.dry_bulb_temperature.resample("1D").mean().idxmin()

        gndts = []
        for j in [i if i > 0 else i + 365 for i in (self.df.index - coldest_day).total_seconds() / 86400]:
            gndts.append(ground_temperature_at_depth(depth, mn, rng, j, soil_diffusivity=0.01))
        self.ground_temperature_at_depth = pd.Series(name="ground_temperature_at_depth", index=self.df.index, data=gndts)
        print("Ground temperature calculated")
        self.df = pd.concat([self.df, self.ground_temperature_at_depth], axis=1)

    def gendaymtx(self, direct=True, reinhart=False):
        # Get dict for selected skytype
        sky_dome = self.reinhart_sky_dome if reinhart else self.tregenza_sky_dome

        # Check for existence of WEA file in object
        if self.wea_file is None:
            self.to_wea()

        # Create output file path
        if direct:
            mtx_file = pathlib.Path(self.wea_file).with_suffix(".dirmtx")
        else:
            mtx_file = pathlib.Path(self.wea_file).with_suffix(".diffmtx")

        # Create run command
        if os.name == "posix":
            cmd = '"/usr/local/radiance/bin/gendaymtx" -m {0:} -{1:} -O1 "{2:}" > "{3:}"'.format(2 if reinhart else 1, "d" if direct else "s", self.wea_file, mtx_file)
        else:
            cmd = '"C:/Radiance/bin/gendaymtx" -m {0:} -{1:} -O1 "{2:}" > "{3:}"'.format(2 if reinhart else 1, "d" if direct else "s", self.wea_file, mtx_file)

        # Run command
        subprocess.run(cmd, shell=True)

        # Load the resultant annual patch-value matrix
        sky_matrix = pd.read_csv(mtx_file, sep="\s+", skip_blank_lines=True, skiprows=8, header=None).values
        sky_matrix = np.sum(sky_matrix * np.array([0.265074126, 0.670114631, 0.064811243]), axis=1)
        sky_matrix = np.array(list(chunk(sky_matrix, 8760))[1:])
        sky_matrix = np.multiply(sky_matrix.T, sky_dome["conversion_factor"])

        return sky_matrix

    def run_gendaymtx(self, reinhart=False):

        # Get dict for selected skytype
        sky_dome = self.reinhart_sky_dome if reinhart else self.tregenza_sky_dome

        self.direct_sky_matrix = self.gendaymtx(direct=True, reinhart=reinhart)
        print("Direct sky matrix calculated: {0:}".format(os.path.relpath(pathlib.Path(self.wea_file).with_suffix(".dirmtx"))))
        self.diffuse_sky_matrix = self.gendaymtx(direct=False, reinhart=reinhart)
        print("Diffuse sky matrix calculated: {0:}".format(os.path.relpath(pathlib.Path(self.wea_file).with_suffix(".diffmtx"))))
        self.total_sky_matrix = self.direct_sky_matrix + self.diffuse_sky_matrix

        self.direct_sky_radiation_rose_values = radiation_rose_values(self.radiation_rose_vectors, sky_dome["patch_vectors"], self.direct_sky_matrix.sum(axis=0))
        self.diffuse_sky_radiation_rose_values = radiation_rose_values(self.radiation_rose_vectors, sky_dome["patch_vectors"], self.diffuse_sky_matrix.sum(axis=0))
        self.total_sky_radiation_rose_values = radiation_rose_values(self.radiation_rose_vectors, sky_dome["patch_vectors"], self.total_sky_matrix.sum(axis=0))

    def plot_radiation_rose(self, close=False, savepath=False):
        import matplotlib.pyplot as plt
        from matplotlib import cm
        if self.total_sky_radiation_rose_values is None:
            print("Run self.run_gendaymtx() before plotting radiation roses")
            return

        max_val = self.total_sky_radiation_rose_values.max() / 1000
        for tx, vals in {"Direct radiation": self.direct_sky_radiation_rose_values, "Diffuse radiation": self.diffuse_sky_radiation_rose_values, "Total radiation": self.total_sky_radiation_rose_values}.items():
            vals = vals / 1000
            colors = [cm.OrRd_r(i) for i in np.interp(vals, [min(vals), max(vals)], [0, 1])]
            fig, ax = plt.subplots(1, 1, figsize=(6, 6), subplot_kw={'projection': "polar"})
            ax.set_theta_zero_location("N")
            ax.set_theta_direction(-1)
            ax.bar(
                self.radiation_rose_angles,
                vals,
                width=(np.pi * 2 / 36) - 0.05, zorder=5, bottom=0.0, color=colors, alpha=1)
            ax.set_ylim(0, max_val)
            ax.spines['polar'].set_visible(False)
            ax.set_xticklabels(["N", "NE", "E", "SE", "S", "SW", "W", "NW"])
            ti = ax.set_title("{} - {} - {}\n{}".format(self.city, self.country, self.station_id, tx), color="k", loc="left", va="bottom", ha="left", fontsize="large", y=1)
            plt.tight_layout()

            if savepath:
                print("Saving to {}".format(savepath))
                fig.savefig(savepath, dpi=300, transparent=False, bbox_inches="tight", bbox_extra_artists=[ti, ])
            if close:
                plt.close()

    # Environment stuff


    # def gen_humidity_ratio_relative_humidity(self):
    #     if self.partial_vapour_pressure is None:
    #         self.gen_partial_vapour_pressure()
    #     pvp = self.relative_humidity / 100 * self.partial_vapour_pressure
    #     # calculate humidity ratio
    #     self.humidity_ratio = 0.621945 * pvp / (self.atmospheric_station_pressure - pvp) # possibly self.atmospheric_station_pressure / 1000 ???
    #
    # def gen_enthalpy(self):
    #     if self.humidity_ratio is None:
    #         self.gen_humidity_ratio_relative_humidity()
    #     self.enthalpy = 1.005 * self.dry_bulb_temperature + self.humidity_ratio * (2501 + 1.86 * self.dry_bulb_temperature)
    #
    # def gen_wet_bulb_temperature(self):
    #     if self.humidity_ratio is None:
    #         self.gen_humidity_ratio_relative_humidity()
    #     if self.partial_vapour_pressure is None:
    #         self.gen_partial_vapour_pressure()
    #
    #     # Initial Wet Bulb Temp (equal to dry_bulb_temperature)
    #     wet_bulb_temperature1 = self.dry_bulb_temperature
    #
    #     # calculate saturation humidity ratio of wet bulb temperature
    #     saturation_vapour_pressure = 0.621945 * partial_vapour_pressure(wet_bulb_temperature1) / (
    #                 self.atmospheric_station_pressure * 1000 - partial_vapour_pressure(wet_bulb_temperature1))
    #
    #     # calculate humidity ratio of partial vapour pressure
    #     humidity_ratio = humidity_ratio_relative_humidity(dry_bulb_temperature, relative_humidity, pressure)
    #
    #     # calculate wet bulb temperature
    #     wet_bulb_temperature2 = ((
    #                                          2501 + 1.86 * dry_bulb_temperature) * humidity_ratio - 2501 * saturation_vapour_pressure + 1.006 * dry_bulb_temperature) / (
    #                                         1.006 + 4.186 * humidity_ratio - 2.326 * saturation_vapour_pressure)
    #
    #     myerror = wet_bulb_temperature2 - wet_bulb_temperature1
    #
    #     if dry_bulb_temperature < 0:
    #         while abs(myerror) > 0.001:
    #             wet_bulb_temperature1 = 0.1 * myerror + wet_bulb_temperature1
    #             saturation_vapour_pressure = 0.621945 * partial_vapour_pressure(wet_bulb_temperature1) / (
    #                         pressure * 1000 - partial_vapour_pressure(wet_bulb_temperature1))
    #             wet_bulb_temperature2 = ((
    #                                                  2830 + 1.86 * dry_bulb_temperature) * humidity_ratio - 2830 * saturation_vapour_pressure + 1.006 * dry_bulb_temperature) / (
    #                                                 1.006 + 2.1 * humidity_ratio - 0.24 * saturation_vapour_pressure)
    #             myerror = wet_bulb_temperature2 - wet_bulb_temperature1
    #     else:
    #         while abs(myerror) > 0.001:
    #             wet_bulb_temperature1 = 0.01 * myerror + wet_bulb_temperature1
    #             saturation_vapour_pressure = 0.621945 * partial_vapour_pressure(wet_bulb_temperature1) / (
    #                         pressure * 1000 - partial_vapour_pressure(wet_bulb_temperature1))
    #             wet_bulb_temperature2 = ((
    #                                                  2501 + 1.86 * dry_bulb_temperature) * humidity_ratio - 2501 * saturation_vapour_pressure + 1.006 * dry_bulb_temperature) / (
    #                                                 1.006 + 4.186 * humidity_ratio - 2.326 * saturation_vapour_pressure)
    #             myerror = wet_bulb_temperature2 - wet_bulb_temperature1
    #
    #     self.wet_bulb_temperature = wet_bulb_temperature2

    # NV method stuff

    def gen_pedestrian_wind_speed(self):
        self.pedestrian_wind_speed = pd.Series(name="pedestrian_wind_speed", index=self.df.index, data=[wind_speed_at_height(ws=i, source_wind_height=10, target_wind_height=1.5) for i in self.wind_speed])
        print("Pedestrian wind-speed calculated")
        self.df = pd.concat([self.df, self.pedestrian_wind_speed], axis=1)

    def gen_numerous_vectors(self, n_samples=100):
        # Returns vec, alt, sky
        vectors = []
        thetas = []
        sky = []
        offset = 2 / n_samples
        increment = math.pi * (3 - math.sqrt(5))
        for i in range(n_samples):
            y = ((i * offset) - 1) + (offset / 2)
            r = math.sqrt(1 - math.pow(y, 2))
            phi = i * increment
            x = math.cos(phi) * r
            z = math.sin(phi) * r
            theta = math.atan(z / math.sqrt(math.pow(x, 2) + math.pow(y, 2)))
            theta = math.fabs(theta)
            thetas.append(theta)
            vec = unit_vector([x, y, z])
            vectors.append(vec)
            if z > 0:
                sky.append(True)
            else:
                sky.append(False)
        self.vec = np.array(vectors)
        self.thetas = np.array(thetas)
        self.sky = np.array(sky)

    def gen_sky_emissivity(self):
        dpt = self.dew_point_temperature + 273.15
        tsc = self.total_sky_cover / 10
        self.sky_emissivity = (0.787 + 0.764 * np.log(dpt / 273.15)) * (1 + 0.0224 * tsc - 0.0035 * np.power(tsc, 2) + 0.0028 * np.power(tsc, 3))

    def gen_horizontal_ir(self):
        stefan_boltzmann_constant = 5.6697E-8
        dbt = self.dry_bulb_temperature + 273.15
        self.nv_horizontal_ir = self.sky_emissivity * stefan_boltzmann_constant * np.power(dbt, 4)

    def gen_convective_heat_transfer_coefficient(self, roughness="Concrete (Medium Rough)"):
        material = {
            "Stucco (Very Rough)": {"D": 11.58, "E": 5.89, "F": 0},
            "Brick (Rough)": {"D": 12.49, "E": 4.065, "F": 0.028},
            'Concrete (Medium Rough)': {"D": 10.79, "E": 4.192, "F": 0},
            'Clear pine (Medium Smooth)': {"D": 8.23, "E": 4, "F": -0.057},
            'Smooth Plaster(Smooth)': {"D": 10.22, "E": 3.1, "F": 0},
            'Glass (Very Smooth)': {"D": 8.23, "E": 3.33, "F": -0.036},
        }
        ws = self.pedestrian_wind_speed
        self.convective_heat_transfer_coefficient = material[roughness]["D"] + material[roughness]["E"] * ws + material[roughness]["F"] * np.power(ws, 2)

    def sky_dome_resample(self):
        # Calculate the distance and indices of the points on the radiation dome, nearby the sample points
        # This part can be calculated once, regardless of the hour of year
        # For each vector/point in the dis_sph generated sample points, get the distance and indices of nearby points
        self.distances, self.indices = spatial.KDTree(self.reinhart_sky_dome["patch_centroids"]).query(self.vec, 3)





